{"ast":null,"code":"var _jsxFileName = \"C:\\\\University\\\\CSCI2720\\\\project\\\\CSCI2720\\\\client\\\\src\\\\pages\\\\MapPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MapPage = () => {\n  _s();\n  const [selectedLocation, setSelectedLocation] = useState(null);\n  const [locationName, setLocationName] = useState('');\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [isCommentsPaneOpen, setIsCommentsPaneOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const mapRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const markersRef = useRef([]);\n  const paneRef = useRef(null);\n\n  // æ¨¡æ‹Ÿä½ç½®æ•°æ®ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä»APIè·å–ï¼‰\n  const mockLocations = [{\n    id: '3110031',\n    name: 'Hong Kong Cultural Centre',\n    latitude: 22.2933,\n    longitude: 114.1699\n  }, {\n    id: '3110267',\n    name: 'Hong Kong City Hall',\n    latitude: 22.2819,\n    longitude: 114.1586\n  }, {\n    id: '3110565',\n    name: 'Ko Shan Theatre',\n    latitude: 22.3367,\n    longitude: 114.1875\n  }, {\n    id: '35510043',\n    name: 'Kwai Tsing Theatre',\n    latitude: 22.3536,\n    longitude: 114.1011\n  }, {\n    id: '35510044',\n    name: 'Sai Wan Ho Civic Centre',\n    latitude: 22.2822,\n    longitude: 114.2292\n  }, {\n    id: '35511887',\n    name: 'Ngau Chi Wan Civic Centre',\n    latitude: 22.3358,\n    longitude: 114.2092\n  }, {\n    id: '35517396',\n    name: 'Yuen Long Theatre',\n    latitude: 22.4450,\n    longitude: 114.0269\n  }, {\n    id: '35517495',\n    name: 'Tuen Mun Town Hall',\n    latitude: 22.3958,\n    longitude: 113.9731\n  }, {\n    id: '36310304',\n    name: 'Sha Tin Town Hall',\n    latitude: 22.3808,\n    longitude: 114.1869\n  }, {\n    id: '36310566',\n    name: 'Tai Po Civic Centre',\n    latitude: 22.4481,\n    longitude: 114.1669\n  }];\n\n  // APIåŸºç¡€URL - åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªåº”è¯¥ä»ç¯å¢ƒå˜é‡ä¸­è·å–\n  const API_BASE_URL = 'http://localhost:3000';\n\n  // æ ·å¼å®šä¹‰\n  const styles = {\n    app: {\n      display: 'flex',\n      flexDirection: 'column',\n      minHeight: '100vh',\n      margin: 0,\n      padding: 0,\n      boxSizing: 'border-box',\n      fontFamily: \"'Arial', sans-serif\",\n      lineHeight: 1.6,\n      color: '#333',\n      position: 'relative'\n    },\n    header: {\n      background: 'linear-gradient(135deg, #2c3e50, #3498db)',\n      color: 'white',\n      padding: '1rem 2rem',\n      boxShadow: '0 2px 10px rgba(0, 0, 0, 0.1)',\n      zIndex: 1000,\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    headerTitle: {\n      fontSize: '1.5rem',\n      margin: 0\n    },\n    main: {\n      flex: 1,\n      display: 'flex',\n      position: 'relative',\n      overflow: 'hidden'\n    },\n    mapContainer: {\n      flex: 1,\n      position: 'relative',\n      zIndex: 1\n    },\n    mainMap: {\n      width: '100%',\n      height: '100%'\n    },\n    // è¯„è®ºå¼¹çª—æ ·å¼\n    commentsPane: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '350px',\n      height: '100%',\n      background: 'white',\n      boxShadow: '2px 0 20px rgba(0, 0, 0, 0.15)',\n      zIndex: 100,\n      transform: isCommentsPaneOpen ? 'translateX(0)' : 'translateX(-100%)',\n      transition: 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n      display: 'flex',\n      flexDirection: 'column',\n      overflow: 'hidden'\n    },\n    paneHeader: {\n      padding: '1.5rem',\n      background: 'linear-gradient(135deg, #2c3e50, #3498db)',\n      color: 'white',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      flexShrink: 0\n    },\n    paneTitle: {\n      margin: 0,\n      fontSize: '1.1rem',\n      fontWeight: '500'\n    },\n    locationName: {\n      fontSize: '0.9rem',\n      opacity: 0.9,\n      marginTop: '0.25rem'\n    },\n    closeButton: {\n      background: 'rgba(255, 255, 255, 0.2)',\n      border: 'none',\n      color: 'white',\n      width: '32px',\n      height: '32px',\n      borderRadius: '50%',\n      cursor: 'pointer',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      transition: 'background 0.3s',\n      fontSize: '1.2rem',\n      flexShrink: 0\n    },\n    paneContent: {\n      flex: 1,\n      overflowY: 'auto',\n      padding: '1.5rem',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    // è¯„è®ºéƒ¨åˆ†\n    commentsSection: {\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    commentsCount: {\n      color: '#2c3e50',\n      marginBottom: '1rem',\n      paddingBottom: '0.75rem',\n      borderBottom: '2px solid #eee',\n      fontSize: '0.9rem',\n      fontWeight: '500'\n    },\n    commentsList: {\n      flex: 1,\n      overflowY: 'auto',\n      marginBottom: '1.5rem'\n    },\n    commentItem: {\n      padding: '1rem',\n      borderBottom: '1px solid #f0f0f0',\n      background: '#fafafa',\n      borderRadius: '8px',\n      marginBottom: '0.75rem'\n    },\n    commentHeader: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      marginBottom: '0.5rem'\n    },\n    commentAuthor: {\n      fontWeight: 'bold',\n      color: '#2c3e50',\n      fontSize: '0.9rem'\n    },\n    commentDate: {\n      color: '#888',\n      fontSize: '0.8rem'\n    },\n    commentText: {\n      color: '#555',\n      lineHeight: 1.5,\n      fontSize: '0.9rem'\n    },\n    noComments: {\n      color: '#999',\n      textAlign: 'center',\n      padding: '3rem 1rem',\n      fontStyle: 'italic',\n      fontSize: '0.9rem'\n    },\n    // æ·»åŠ è¯„è®ºè¡¨å•\n    addCommentSection: {\n      background: '#f8f9fa',\n      padding: '1.5rem',\n      borderRadius: '8px',\n      border: '1px solid #eaeaea',\n      flexShrink: 0\n    },\n    commentFormTitle: {\n      color: '#2c3e50',\n      marginBottom: '1rem',\n      fontSize: '0.9rem',\n      fontWeight: '500'\n    },\n    commentTextarea: {\n      width: '100%',\n      padding: '0.75rem',\n      border: '1px solid #ddd',\n      borderRadius: '6px',\n      resize: 'vertical',\n      marginBottom: '1rem',\n      fontFamily: 'inherit',\n      fontSize: '0.9rem',\n      minHeight: '80px',\n      transition: 'border-color 0.3s',\n      boxSizing: 'border-box'\n    },\n    submitButton: {\n      background: '#3498db',\n      color: 'white',\n      border: 'none',\n      padding: '0.75rem 1.5rem',\n      borderRadius: '6px',\n      cursor: 'pointer',\n      fontSize: '0.9rem',\n      transition: 'background 0.3s',\n      width: '100%',\n      fontWeight: '500'\n    },\n    submitButtonHover: {\n      background: '#2980b9'\n    },\n    submitButtonDisabled: {\n      background: '#bdc3c7',\n      cursor: 'not-allowed'\n    },\n    errorMessage: {\n      color: '#e74c3c',\n      fontSize: '0.9rem',\n      marginBottom: '1rem',\n      padding: '0.5rem',\n      background: '#fdf2f2',\n      borderRadius: '4px',\n      border: '1px solid #f8d7da'\n    },\n    loadingIndicator: {\n      textAlign: 'center',\n      padding: '2rem',\n      color: '#666',\n      fontSize: '0.9rem'\n    },\n    // å åŠ å±‚\n    overlay: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      background: 'rgba(0, 0, 0, 0.4)',\n      zIndex: 50,\n      opacity: isCommentsPaneOpen ? 1 : 0,\n      visibility: isCommentsPaneOpen ? 'visible' : 'hidden',\n      transition: 'opacity 0.3s, visibility 0.3s',\n      cursor: 'pointer'\n    },\n    // å“åº”å¼\n    '@media (max-width: 768px)': {\n      commentsPane: {\n        width: '100%',\n        maxWidth: '100%'\n      }\n    }\n  };\n\n  // åˆå§‹åŒ–åœ°å›¾\n  useEffect(() => {\n    const initMap = () => {\n      if (!mapInstanceRef.current && mapRef.current) {\n        mapInstanceRef.current = L.map(mapRef.current).setView([22.3193, 114.1694], 12);\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '&copy; OpenStreetMap contributors',\n          maxZoom: 18\n        }).addTo(mapInstanceRef.current);\n        addMarkersToMap(mockLocations);\n      }\n    };\n    initMap();\n\n    // å¤„ç†æµè§ˆå™¨å†å²\n    const handlePopState = () => {\n      const url = new URL(window.location.href);\n      const locationId = url.searchParams.get('location');\n      if (locationId) {\n        handleMarkerClick(locationId, false);\n      } else {\n        closeCommentsPane();\n      }\n    };\n    window.addEventListener('popstate', handlePopState);\n\n    // åˆå§‹URLå¤„ç†\n    const url = new URL(window.location.href);\n    const initialLocationId = url.searchParams.get('location');\n    if (initialLocationId) {\n      handleMarkerClick(initialLocationId, false);\n    }\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove();\n        mapInstanceRef.current = null;\n      }\n      window.removeEventListener('popstate', handlePopState);\n    };\n  }, []);\n\n  // æ·»åŠ æ ‡è®°åˆ°åœ°å›¾\n  const addMarkersToMap = locationsData => {\n    if (!mapInstanceRef.current) return;\n\n    // æ¸…é™¤ç°æœ‰æ ‡è®°\n    markersRef.current.forEach(marker => {\n      if (marker && mapInstanceRef.current) {\n        mapInstanceRef.current.removeLayer(marker);\n      }\n    });\n    markersRef.current = [];\n\n    // åˆ›å»ºè‡ªå®šä¹‰å›¾æ ‡\n    const createCustomIcon = (isSelected = false) => {\n      return L.divIcon({\n        className: 'custom-marker',\n        html: `\n                    <div style=\"\n                        background: ${isSelected ? '#e74c3c' : '#3498db'};\n                        width: 36px;\n                        height: 36px;\n                        border-radius: 50%;\n                        border: 3px solid white;\n                        box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                        color: white;\n                        font-weight: bold;\n                        font-size: 16px;\n                        transition: all 0.3s;\n                    \">\n                        <div style=\"transform: translateY(-1px)\">ğŸ“</div>\n                    </div>\n                `,\n        iconSize: [36, 36],\n        iconAnchor: [18, 36]\n      });\n    };\n\n    // æ·»åŠ æ–°æ ‡è®°\n    locationsData.forEach(location => {\n      const isSelected = selectedLocation === location.id;\n      const marker = L.marker([location.latitude, location.longitude], {\n        icon: createCustomIcon(isSelected)\n      }).addTo(mapInstanceRef.current).bindTooltip(location.name, {\n        direction: 'top',\n        offset: [0, -18],\n        opacity: 0.9,\n        className: 'map-tooltip'\n      });\n\n      // æ ‡è®°ç‚¹å‡»äº‹ä»¶\n      marker.on('click', () => {\n        handleMarkerClick(location.id, true);\n      });\n      markersRef.current.push(marker);\n    });\n  };\n\n  // ä»åç«¯APIè·å–è¯„è®º\n  const fetchComments = async locationId => {\n    setIsLoading(true);\n    setError('');\n    try {\n      // è°ƒç”¨åç«¯APIè·å–æŸä¸ªåœ°ç‚¹çš„æ‰€æœ‰è¯„è®º\n      const response = await fetch(`${API_BASE_URL}/comment/loc-all/${locationId}`);\n      if (!response.ok) {\n        throw new Error(`Failed to fetch comments: ${response.status} ${response.statusText}`);\n      }\n      const commentsData = await response.json();\n\n      // å°†åç«¯æ•°æ®è½¬æ¢ä¸ºå‰ç«¯éœ€è¦çš„æ ¼å¼\n      const formattedComments = commentsData.map(comment => ({\n        id: comment.commentId || comment._id,\n        locationId: comment.locationId,\n        username: comment.username || 'Anonymous',\n        // æ ¹æ®åç«¯è¿”å›çš„å®é™…å­—æ®µè°ƒæ•´\n        text: comment.content,\n        date: new Date(comment.timestamp).toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        }),\n        timestamp: comment.timestamp,\n        userId: comment.userId\n      }));\n      return formattedComments;\n    } catch (error) {\n      console.error('Error fetching comments:', error);\n      setError(`Failed to load comments: ${error.message}`);\n      return [];\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // å‘åç«¯APIæäº¤è¯„è®º\n  const submitComment = async commentData => {\n    setIsLoading(true);\n    setError('');\n    try {\n      // è·å–è®¤è¯tokenï¼ˆå‡è®¾å­˜å‚¨åœ¨localStorageä¸­ï¼‰\n      const token = localStorage.getItem('authToken');\n      const response = await fetch(`${API_BASE_URL}/comment/send`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token && {\n            'Authorization': `Bearer ${token}`\n          })\n        },\n        body: JSON.stringify({\n          locID: commentData.locationId,\n          content: commentData.text\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `Failed to submit comment: ${response.status}`);\n      }\n      const result = await response.json();\n\n      // è¿”å›æ–°åˆ›å»ºçš„è¯„è®º\n      return {\n        id: result.comment._id || Date.now(),\n        locationId: commentData.locationId,\n        username: commentData.username,\n        text: commentData.text,\n        date: new Date().toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        }),\n        timestamp: new Date().toISOString()\n      };\n    } catch (error) {\n      console.error('Error submitting comment:', error);\n      setError(`Failed to submit comment: ${error.message}`);\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // å¤„ç†æ ‡è®°ç‚¹å‡»\n  const handleMarkerClick = async (locationId, pushHistory = true) => {\n    // æ‰¾åˆ°ä½ç½®ä¿¡æ¯\n    const location = mockLocations.find(loc => loc.id === locationId);\n    if (!location) return;\n\n    // æ›´æ–°é€‰ä¸­çš„ä½ç½®\n    setSelectedLocation(locationId);\n    setLocationName(location.name);\n\n    // ä»APIåŠ è½½è¯„è®º\n    const locationComments = await fetchComments(locationId);\n    setComments(locationComments);\n\n    // æ‰“å¼€è¯„è®ºå¼¹çª—\n    setIsCommentsPaneOpen(true);\n\n    // æ›´æ–°URLå¹¶æ¨å…¥å†å²è®°å½•ï¼ˆå¦‚æœéœ€è¦ï¼‰\n    if (pushHistory) {\n      const url = new URL(window.location.href);\n      url.searchParams.set('location', locationId);\n      window.history.pushState({\n        locationId\n      }, '', url);\n    }\n\n    // é‡æ–°æ¸²æŸ“æ ‡è®°ä»¥æ›´æ–°é€‰ä¸­çŠ¶æ€\n    addMarkersToMap(mockLocations);\n\n    // å±…ä¸­æ˜¾ç¤ºé€‰ä¸­çš„æ ‡è®°\n    if (mapInstanceRef.current) {\n      mapInstanceRef.current.setView([location.latitude, location.longitude], 14);\n    }\n  };\n\n  // å…³é—­è¯„è®ºå¼¹çª—\n  const closeCommentsPane = () => {\n    setIsCommentsPaneOpen(false);\n    setSelectedLocation(null);\n    setLocationName('');\n    setComments([]);\n    setNewComment('');\n    setError('');\n\n    // æ›´æ–°URL\n    const url = new URL(window.location.href);\n    url.searchParams.delete('location');\n    window.history.pushState({}, '', url);\n\n    // é‡æ–°æ¸²æŸ“æ ‡è®°ä»¥æ¸…é™¤é€‰ä¸­çŠ¶æ€\n    addMarkersToMap(mockLocations);\n\n    // é‡ç½®åœ°å›¾è§†å›¾\n    if (mapInstanceRef.current) {\n      mapInstanceRef.current.setView([22.3193, 114.1694], 12);\n    }\n  };\n\n  // æ·»åŠ è¯„è®º\n  const handleAddComment = async () => {\n    if (newComment.trim() === '' || !selectedLocation) return;\n    try {\n      // æ¨¡æ‹Ÿå½“å‰ç”¨æˆ·ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä»ç™»å½•çŠ¶æ€è·å–ï¼‰\n      const currentUser = localStorage.getItem('currentUser') || 'Current User';\n      const commentData = {\n        locationId: selectedLocation,\n        username: currentUser,\n        text: newComment.trim()\n      };\n\n      // æäº¤è¯„è®ºåˆ°åç«¯API\n      const newCommentObj = await submitComment(commentData);\n\n      // æ›´æ–°è¯„è®ºåˆ—è¡¨\n      setComments(prevComments => [...prevComments, newCommentObj]);\n      setNewComment('');\n    } catch (error) {\n      console.error('Failed to add comment:', error);\n      // é”™è¯¯ä¿¡æ¯å·²ç»åœ¨submitCommentå‡½æ•°ä¸­è®¾ç½®äº†\n    }\n  };\n\n  // å¤„ç†é”®ç›˜äº‹ä»¶\n  useEffect(() => {\n    const handleKeyDown = e => {\n      if (e.key === 'Escape' && isCommentsPaneOpen) {\n        closeCommentsPane();\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isCommentsPaneOpen]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.app,\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      style: styles.header,\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        style: styles.headerTitle,\n        children: \"Cultural Events Hong Kong\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      style: styles.main,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.mapContainer,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: mapRef,\n          style: styles.mainMap\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 606,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: paneRef,\n        style: styles.commentsPane,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.paneHeader,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              style: styles.paneTitle,\n              children: locationName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 29\n            }, this), locationName && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.locationName,\n              children: \"Comments\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 619,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeCommentsPane,\n            style: styles.closeButton,\n            \"aria-label\": \"Close comments pane\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 624,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 615,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.paneContent,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.commentsSection,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.commentsCount,\n              children: [comments.length, \" \", comments.length === 1 ? 'Comment' : 'Comments']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 635,\n              columnNumber: 29\n            }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.errorMessage,\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 640,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.commentsList,\n              children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n                style: styles.loadingIndicator,\n                children: \"Loading comments...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 647,\n                columnNumber: 37\n              }, this) : comments.length > 0 ? comments.map(comment => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: styles.commentItem,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: styles.commentHeader,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: styles.commentAuthor,\n                    children: comment.username\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 654,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: styles.commentDate,\n                    children: comment.date\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 657,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 653,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: styles.commentText,\n                  children: comment.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 661,\n                  columnNumber: 45\n                }, this)]\n              }, comment.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 652,\n                columnNumber: 41\n              }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                style: styles.noComments,\n                children: [\"No comments yet for this location.\", /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginTop: '0.5rem',\n                    fontSize: '0.8rem'\n                  },\n                  children: \"Be the first to share your experience!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 669,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 667,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: styles.addCommentSection,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: styles.commentFormTitle,\n                children: \"Add a Comment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 677,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: newComment,\n                onChange: e => setNewComment(e.target.value),\n                placeholder: \"Share your thoughts about this venue...\",\n                style: styles.commentTextarea,\n                rows: \"3\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 680,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleAddComment,\n                style: {\n                  ...styles.submitButton,\n                  ...(newComment.trim() === '' || isLoading ? styles.submitButtonDisabled : {})\n                },\n                disabled: newComment.trim() === '' || isLoading,\n                children: isLoading ? 'Posting...' : 'Post Comment'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 688,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 676,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 634,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 633,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 611,\n        columnNumber: 17\n      }, this), isCommentsPaneOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.overlay,\n        onClick: closeCommentsPane\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 705,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      style: {\n        background: '#2c3e50',\n        color: 'white',\n        textAlign: 'center',\n        padding: '1rem',\n        fontSize: '0.9rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\xA9 2024 Cultural Events Web Application | Click on any marker to view and post comments\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 719,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 712,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 599,\n    columnNumber: 9\n  }, this);\n};\n_s(MapPage, \"STBVnNSN1YiVQzLGhjJwjeIYAK0=\");\n_c = MapPage;\nexport default MapPage;\nvar _c;\n$RefreshReg$(_c, \"MapPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","L","jsxDEV","_jsxDEV","MapPage","_s","selectedLocation","setSelectedLocation","locationName","setLocationName","comments","setComments","newComment","setNewComment","isCommentsPaneOpen","setIsCommentsPaneOpen","isLoading","setIsLoading","error","setError","mapRef","mapInstanceRef","markersRef","paneRef","mockLocations","id","name","latitude","longitude","API_BASE_URL","styles","app","display","flexDirection","minHeight","margin","padding","boxSizing","fontFamily","lineHeight","color","position","header","background","boxShadow","zIndex","justifyContent","alignItems","headerTitle","fontSize","main","flex","overflow","mapContainer","mainMap","width","height","commentsPane","top","left","transform","transition","paneHeader","flexShrink","paneTitle","fontWeight","opacity","marginTop","closeButton","border","borderRadius","cursor","paneContent","overflowY","commentsSection","commentsCount","marginBottom","paddingBottom","borderBottom","commentsList","commentItem","commentHeader","commentAuthor","commentDate","commentText","noComments","textAlign","fontStyle","addCommentSection","commentFormTitle","commentTextarea","resize","submitButton","submitButtonHover","submitButtonDisabled","errorMessage","loadingIndicator","overlay","right","bottom","visibility","maxWidth","initMap","current","map","setView","tileLayer","attribution","maxZoom","addTo","addMarkersToMap","handlePopState","url","URL","window","location","href","locationId","searchParams","get","handleMarkerClick","closeCommentsPane","addEventListener","initialLocationId","remove","removeEventListener","locationsData","forEach","marker","removeLayer","createCustomIcon","isSelected","divIcon","className","html","iconSize","iconAnchor","icon","bindTooltip","direction","offset","on","push","fetchComments","response","fetch","ok","Error","status","statusText","commentsData","json","formattedComments","comment","commentId","_id","username","text","content","date","Date","timestamp","toLocaleDateString","year","month","day","userId","console","message","submitComment","commentData","token","localStorage","getItem","method","headers","body","JSON","stringify","locID","errorData","catch","result","now","toISOString","pushHistory","find","loc","locationComments","set","history","pushState","delete","handleAddComment","trim","currentUser","newCommentObj","prevComments","handleKeyDown","e","key","style","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","onClick","length","value","onChange","target","placeholder","rows","disabled","_c","$RefreshReg$"],"sources":["C:/University/CSCI2720/project/CSCI2720/client/src/pages/MapPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\nconst MapPage = () => {\r\n    const [selectedLocation, setSelectedLocation] = useState(null);\r\n    const [locationName, setLocationName] = useState('');\r\n    const [comments, setComments] = useState([]);\r\n    const [newComment, setNewComment] = useState('');\r\n    const [isCommentsPaneOpen, setIsCommentsPaneOpen] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    \r\n    const mapRef = useRef(null);\r\n    const mapInstanceRef = useRef(null);\r\n    const markersRef = useRef([]);\r\n    const paneRef = useRef(null);\r\n\r\n    // æ¨¡æ‹Ÿä½ç½®æ•°æ®ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä»APIè·å–ï¼‰\r\n    const mockLocations = [\r\n        { id: '3110031', name: 'Hong Kong Cultural Centre', latitude: 22.2933, longitude: 114.1699 },\r\n        { id: '3110267', name: 'Hong Kong City Hall', latitude: 22.2819, longitude: 114.1586 },\r\n        { id: '3110565', name: 'Ko Shan Theatre', latitude: 22.3367, longitude: 114.1875 },\r\n        { id: '35510043', name: 'Kwai Tsing Theatre', latitude: 22.3536, longitude: 114.1011 },\r\n        { id: '35510044', name: 'Sai Wan Ho Civic Centre', latitude: 22.2822, longitude: 114.2292 },\r\n        { id: '35511887', name: 'Ngau Chi Wan Civic Centre', latitude: 22.3358, longitude: 114.2092 },\r\n        { id: '35517396', name: 'Yuen Long Theatre', latitude: 22.4450, longitude: 114.0269 },\r\n        { id: '35517495', name: 'Tuen Mun Town Hall', latitude: 22.3958, longitude: 113.9731 },\r\n        { id: '36310304', name: 'Sha Tin Town Hall', latitude: 22.3808, longitude: 114.1869 },\r\n        { id: '36310566', name: 'Tai Po Civic Centre', latitude: 22.4481, longitude: 114.1669 }\r\n    ];\r\n\r\n    // APIåŸºç¡€URL - åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªåº”è¯¥ä»ç¯å¢ƒå˜é‡ä¸­è·å–\r\n    const API_BASE_URL = 'http://localhost:3000';\r\n\r\n    // æ ·å¼å®šä¹‰\r\n    const styles = {\r\n        app: {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            minHeight: '100vh',\r\n            margin: 0,\r\n            padding: 0,\r\n            boxSizing: 'border-box',\r\n            fontFamily: \"'Arial', sans-serif\",\r\n            lineHeight: 1.6,\r\n            color: '#333',\r\n            position: 'relative'\r\n        },\r\n        \r\n        header: {\r\n            background: 'linear-gradient(135deg, #2c3e50, #3498db)',\r\n            color: 'white',\r\n            padding: '1rem 2rem',\r\n            boxShadow: '0 2px 10px rgba(0, 0, 0, 0.1)',\r\n            zIndex: 1000,\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center'\r\n        },\r\n        \r\n        headerTitle: {\r\n            fontSize: '1.5rem',\r\n            margin: 0\r\n        },\r\n        \r\n        main: {\r\n            flex: 1,\r\n            display: 'flex',\r\n            position: 'relative',\r\n            overflow: 'hidden'\r\n        },\r\n        \r\n        mapContainer: {\r\n            flex: 1,\r\n            position: 'relative',\r\n            zIndex: 1\r\n        },\r\n        \r\n        mainMap: {\r\n            width: '100%',\r\n            height: '100%'\r\n        },\r\n        \r\n        // è¯„è®ºå¼¹çª—æ ·å¼\r\n        commentsPane: {\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            width: '350px',\r\n            height: '100%',\r\n            background: 'white',\r\n            boxShadow: '2px 0 20px rgba(0, 0, 0, 0.15)',\r\n            zIndex: 100,\r\n            transform: isCommentsPaneOpen ? 'translateX(0)' : 'translateX(-100%)',\r\n            transition: 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            overflow: 'hidden'\r\n        },\r\n        \r\n        paneHeader: {\r\n            padding: '1.5rem',\r\n            background: 'linear-gradient(135deg, #2c3e50, #3498db)',\r\n            color: 'white',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            flexShrink: 0\r\n        },\r\n        \r\n        paneTitle: {\r\n            margin: 0,\r\n            fontSize: '1.1rem',\r\n            fontWeight: '500'\r\n        },\r\n        \r\n        locationName: {\r\n            fontSize: '0.9rem',\r\n            opacity: 0.9,\r\n            marginTop: '0.25rem'\r\n        },\r\n        \r\n        closeButton: {\r\n            background: 'rgba(255, 255, 255, 0.2)',\r\n            border: 'none',\r\n            color: 'white',\r\n            width: '32px',\r\n            height: '32px',\r\n            borderRadius: '50%',\r\n            cursor: 'pointer',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            transition: 'background 0.3s',\r\n            fontSize: '1.2rem',\r\n            flexShrink: 0\r\n        },\r\n        \r\n        paneContent: {\r\n            flex: 1,\r\n            overflowY: 'auto',\r\n            padding: '1.5rem',\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n        },\r\n        \r\n        // è¯„è®ºéƒ¨åˆ†\r\n        commentsSection: {\r\n            flex: 1,\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n        },\r\n        \r\n        commentsCount: {\r\n            color: '#2c3e50',\r\n            marginBottom: '1rem',\r\n            paddingBottom: '0.75rem',\r\n            borderBottom: '2px solid #eee',\r\n            fontSize: '0.9rem',\r\n            fontWeight: '500'\r\n        },\r\n        \r\n        commentsList: {\r\n            flex: 1,\r\n            overflowY: 'auto',\r\n            marginBottom: '1.5rem'\r\n        },\r\n        \r\n        commentItem: {\r\n            padding: '1rem',\r\n            borderBottom: '1px solid #f0f0f0',\r\n            background: '#fafafa',\r\n            borderRadius: '8px',\r\n            marginBottom: '0.75rem'\r\n        },\r\n        \r\n        commentHeader: {\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            marginBottom: '0.5rem'\r\n        },\r\n        \r\n        commentAuthor: {\r\n            fontWeight: 'bold',\r\n            color: '#2c3e50',\r\n            fontSize: '0.9rem'\r\n        },\r\n        \r\n        commentDate: {\r\n            color: '#888',\r\n            fontSize: '0.8rem'\r\n        },\r\n        \r\n        commentText: {\r\n            color: '#555',\r\n            lineHeight: 1.5,\r\n            fontSize: '0.9rem'\r\n        },\r\n        \r\n        noComments: {\r\n            color: '#999',\r\n            textAlign: 'center',\r\n            padding: '3rem 1rem',\r\n            fontStyle: 'italic',\r\n            fontSize: '0.9rem'\r\n        },\r\n        \r\n        // æ·»åŠ è¯„è®ºè¡¨å•\r\n        addCommentSection: {\r\n            background: '#f8f9fa',\r\n            padding: '1.5rem',\r\n            borderRadius: '8px',\r\n            border: '1px solid #eaeaea',\r\n            flexShrink: 0\r\n        },\r\n        \r\n        commentFormTitle: {\r\n            color: '#2c3e50',\r\n            marginBottom: '1rem',\r\n            fontSize: '0.9rem',\r\n            fontWeight: '500'\r\n        },\r\n        \r\n        commentTextarea: {\r\n            width: '100%',\r\n            padding: '0.75rem',\r\n            border: '1px solid #ddd',\r\n            borderRadius: '6px',\r\n            resize: 'vertical',\r\n            marginBottom: '1rem',\r\n            fontFamily: 'inherit',\r\n            fontSize: '0.9rem',\r\n            minHeight: '80px',\r\n            transition: 'border-color 0.3s',\r\n            boxSizing: 'border-box'\r\n        },\r\n        \r\n        submitButton: {\r\n            background: '#3498db',\r\n            color: 'white',\r\n            border: 'none',\r\n            padding: '0.75rem 1.5rem',\r\n            borderRadius: '6px',\r\n            cursor: 'pointer',\r\n            fontSize: '0.9rem',\r\n            transition: 'background 0.3s',\r\n            width: '100%',\r\n            fontWeight: '500'\r\n        },\r\n        \r\n        submitButtonHover: {\r\n            background: '#2980b9'\r\n        },\r\n        \r\n        submitButtonDisabled: {\r\n            background: '#bdc3c7',\r\n            cursor: 'not-allowed'\r\n        },\r\n        \r\n        errorMessage: {\r\n            color: '#e74c3c',\r\n            fontSize: '0.9rem',\r\n            marginBottom: '1rem',\r\n            padding: '0.5rem',\r\n            background: '#fdf2f2',\r\n            borderRadius: '4px',\r\n            border: '1px solid #f8d7da'\r\n        },\r\n        \r\n        loadingIndicator: {\r\n            textAlign: 'center',\r\n            padding: '2rem',\r\n            color: '#666',\r\n            fontSize: '0.9rem'\r\n        },\r\n        \r\n        // å åŠ å±‚\r\n        overlay: {\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: 'rgba(0, 0, 0, 0.4)',\r\n            zIndex: 50,\r\n            opacity: isCommentsPaneOpen ? 1 : 0,\r\n            visibility: isCommentsPaneOpen ? 'visible' : 'hidden',\r\n            transition: 'opacity 0.3s, visibility 0.3s',\r\n            cursor: 'pointer'\r\n        },\r\n        \r\n        // å“åº”å¼\r\n        '@media (max-width: 768px)': {\r\n            commentsPane: {\r\n                width: '100%',\r\n                maxWidth: '100%'\r\n            }\r\n        }\r\n    };\r\n\r\n    // åˆå§‹åŒ–åœ°å›¾\r\n    useEffect(() => {\r\n        const initMap = () => {\r\n            if (!mapInstanceRef.current && mapRef.current) {\r\n                mapInstanceRef.current = L.map(mapRef.current).setView([22.3193, 114.1694], 12);\r\n                \r\n                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n                    attribution: '&copy; OpenStreetMap contributors',\r\n                    maxZoom: 18\r\n                }).addTo(mapInstanceRef.current);\r\n                \r\n                addMarkersToMap(mockLocations);\r\n            }\r\n        };\r\n\r\n        initMap();\r\n\r\n        // å¤„ç†æµè§ˆå™¨å†å²\r\n        const handlePopState = () => {\r\n            const url = new URL(window.location.href);\r\n            const locationId = url.searchParams.get('location');\r\n            \r\n            if (locationId) {\r\n                handleMarkerClick(locationId, false);\r\n            } else {\r\n                closeCommentsPane();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('popstate', handlePopState);\r\n        \r\n        // åˆå§‹URLå¤„ç†\r\n        const url = new URL(window.location.href);\r\n        const initialLocationId = url.searchParams.get('location');\r\n        if (initialLocationId) {\r\n            handleMarkerClick(initialLocationId, false);\r\n        }\r\n\r\n        return () => {\r\n            if (mapInstanceRef.current) {\r\n                mapInstanceRef.current.remove();\r\n                mapInstanceRef.current = null;\r\n            }\r\n            window.removeEventListener('popstate', handlePopState);\r\n        };\r\n    }, []);\r\n\r\n    // æ·»åŠ æ ‡è®°åˆ°åœ°å›¾\r\n    const addMarkersToMap = (locationsData) => {\r\n        if (!mapInstanceRef.current) return;\r\n\r\n        // æ¸…é™¤ç°æœ‰æ ‡è®°\r\n        markersRef.current.forEach(marker => {\r\n            if (marker && mapInstanceRef.current) {\r\n                mapInstanceRef.current.removeLayer(marker);\r\n            }\r\n        });\r\n        markersRef.current = [];\r\n\r\n        // åˆ›å»ºè‡ªå®šä¹‰å›¾æ ‡\r\n        const createCustomIcon = (isSelected = false) => {\r\n            return L.divIcon({\r\n                className: 'custom-marker',\r\n                html: `\r\n                    <div style=\"\r\n                        background: ${isSelected ? '#e74c3c' : '#3498db'};\r\n                        width: 36px;\r\n                        height: 36px;\r\n                        border-radius: 50%;\r\n                        border: 3px solid white;\r\n                        box-shadow: 0 2px 8px rgba(0,0,0,0.3);\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        color: white;\r\n                        font-weight: bold;\r\n                        font-size: 16px;\r\n                        transition: all 0.3s;\r\n                    \">\r\n                        <div style=\"transform: translateY(-1px)\">ğŸ“</div>\r\n                    </div>\r\n                `,\r\n                iconSize: [36, 36],\r\n                iconAnchor: [18, 36]\r\n            });\r\n        };\r\n\r\n        // æ·»åŠ æ–°æ ‡è®°\r\n        locationsData.forEach(location => {\r\n            const isSelected = selectedLocation === location.id;\r\n            const marker = L.marker([location.latitude, location.longitude], {\r\n                icon: createCustomIcon(isSelected)\r\n            })\r\n                .addTo(mapInstanceRef.current)\r\n                .bindTooltip(location.name, {\r\n                    direction: 'top',\r\n                    offset: [0, -18],\r\n                    opacity: 0.9,\r\n                    className: 'map-tooltip'\r\n                });\r\n            \r\n            // æ ‡è®°ç‚¹å‡»äº‹ä»¶\r\n            marker.on('click', () => {\r\n                handleMarkerClick(location.id, true);\r\n            });\r\n\r\n            markersRef.current.push(marker);\r\n        });\r\n    };\r\n\r\n    // ä»åç«¯APIè·å–è¯„è®º\r\n    const fetchComments = async (locationId) => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        \r\n        try {\r\n            // è°ƒç”¨åç«¯APIè·å–æŸä¸ªåœ°ç‚¹çš„æ‰€æœ‰è¯„è®º\r\n            const response = await fetch(`${API_BASE_URL}/comment/loc-all/${locationId}`);\r\n            \r\n            if (!response.ok) {\r\n                throw new Error(`Failed to fetch comments: ${response.status} ${response.statusText}`);\r\n            }\r\n            \r\n            const commentsData = await response.json();\r\n            \r\n            // å°†åç«¯æ•°æ®è½¬æ¢ä¸ºå‰ç«¯éœ€è¦çš„æ ¼å¼\r\n            const formattedComments = commentsData.map(comment => ({\r\n                id: comment.commentId || comment._id,\r\n                locationId: comment.locationId,\r\n                username: comment.username || 'Anonymous', // æ ¹æ®åç«¯è¿”å›çš„å®é™…å­—æ®µè°ƒæ•´\r\n                text: comment.content,\r\n                date: new Date(comment.timestamp).toLocaleDateString('en-US', { \r\n                    year: 'numeric', \r\n                    month: 'short', \r\n                    day: 'numeric' \r\n                }),\r\n                timestamp: comment.timestamp,\r\n                userId: comment.userId\r\n            }));\r\n            \r\n            return formattedComments;\r\n        } catch (error) {\r\n            console.error('Error fetching comments:', error);\r\n            setError(`Failed to load comments: ${error.message}`);\r\n            return [];\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    // å‘åç«¯APIæäº¤è¯„è®º\r\n    const submitComment = async (commentData) => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        \r\n        try {\r\n            // è·å–è®¤è¯tokenï¼ˆå‡è®¾å­˜å‚¨åœ¨localStorageä¸­ï¼‰\r\n            const token = localStorage.getItem('authToken');\r\n            \r\n            const response = await fetch(`${API_BASE_URL}/comment/send`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    ...(token && { 'Authorization': `Bearer ${token}` })\r\n                },\r\n                body: JSON.stringify({\r\n                    locID: commentData.locationId,\r\n                    content: commentData.text\r\n                })\r\n            });\r\n            \r\n            if (!response.ok) {\r\n                const errorData = await response.json().catch(() => ({}));\r\n                throw new Error(errorData.error || `Failed to submit comment: ${response.status}`);\r\n            }\r\n            \r\n            const result = await response.json();\r\n            \r\n            // è¿”å›æ–°åˆ›å»ºçš„è¯„è®º\r\n            return {\r\n                id: result.comment._id || Date.now(),\r\n                locationId: commentData.locationId,\r\n                username: commentData.username,\r\n                text: commentData.text,\r\n                date: new Date().toLocaleDateString('en-US', { \r\n                    year: 'numeric', \r\n                    month: 'short', \r\n                    day: 'numeric' \r\n                }),\r\n                timestamp: new Date().toISOString()\r\n            };\r\n        } catch (error) {\r\n            console.error('Error submitting comment:', error);\r\n            setError(`Failed to submit comment: ${error.message}`);\r\n            throw error;\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    // å¤„ç†æ ‡è®°ç‚¹å‡»\r\n    const handleMarkerClick = async (locationId, pushHistory = true) => {\r\n        // æ‰¾åˆ°ä½ç½®ä¿¡æ¯\r\n        const location = mockLocations.find(loc => loc.id === locationId);\r\n        if (!location) return;\r\n        \r\n        // æ›´æ–°é€‰ä¸­çš„ä½ç½®\r\n        setSelectedLocation(locationId);\r\n        setLocationName(location.name);\r\n        \r\n        // ä»APIåŠ è½½è¯„è®º\r\n        const locationComments = await fetchComments(locationId);\r\n        setComments(locationComments);\r\n        \r\n        // æ‰“å¼€è¯„è®ºå¼¹çª—\r\n        setIsCommentsPaneOpen(true);\r\n        \r\n        // æ›´æ–°URLå¹¶æ¨å…¥å†å²è®°å½•ï¼ˆå¦‚æœéœ€è¦ï¼‰\r\n        if (pushHistory) {\r\n            const url = new URL(window.location.href);\r\n            url.searchParams.set('location', locationId);\r\n            window.history.pushState({ locationId }, '', url);\r\n        }\r\n        \r\n        // é‡æ–°æ¸²æŸ“æ ‡è®°ä»¥æ›´æ–°é€‰ä¸­çŠ¶æ€\r\n        addMarkersToMap(mockLocations);\r\n        \r\n        // å±…ä¸­æ˜¾ç¤ºé€‰ä¸­çš„æ ‡è®°\r\n        if (mapInstanceRef.current) {\r\n            mapInstanceRef.current.setView([location.latitude, location.longitude], 14);\r\n        }\r\n    };\r\n\r\n    // å…³é—­è¯„è®ºå¼¹çª—\r\n    const closeCommentsPane = () => {\r\n        setIsCommentsPaneOpen(false);\r\n        setSelectedLocation(null);\r\n        setLocationName('');\r\n        setComments([]);\r\n        setNewComment('');\r\n        setError('');\r\n        \r\n        // æ›´æ–°URL\r\n        const url = new URL(window.location.href);\r\n        url.searchParams.delete('location');\r\n        window.history.pushState({}, '', url);\r\n        \r\n        // é‡æ–°æ¸²æŸ“æ ‡è®°ä»¥æ¸…é™¤é€‰ä¸­çŠ¶æ€\r\n        addMarkersToMap(mockLocations);\r\n        \r\n        // é‡ç½®åœ°å›¾è§†å›¾\r\n        if (mapInstanceRef.current) {\r\n            mapInstanceRef.current.setView([22.3193, 114.1694], 12);\r\n        }\r\n    };\r\n\r\n    // æ·»åŠ è¯„è®º\r\n    const handleAddComment = async () => {\r\n        if (newComment.trim() === '' || !selectedLocation) return;\r\n        \r\n        try {\r\n            // æ¨¡æ‹Ÿå½“å‰ç”¨æˆ·ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥ä»ç™»å½•çŠ¶æ€è·å–ï¼‰\r\n            const currentUser = localStorage.getItem('currentUser') || 'Current User';\r\n            \r\n            const commentData = {\r\n                locationId: selectedLocation,\r\n                username: currentUser,\r\n                text: newComment.trim()\r\n            };\r\n            \r\n            // æäº¤è¯„è®ºåˆ°åç«¯API\r\n            const newCommentObj = await submitComment(commentData);\r\n            \r\n            // æ›´æ–°è¯„è®ºåˆ—è¡¨\r\n            setComments(prevComments => [...prevComments, newCommentObj]);\r\n            setNewComment('');\r\n            \r\n        } catch (error) {\r\n            console.error('Failed to add comment:', error);\r\n            // é”™è¯¯ä¿¡æ¯å·²ç»åœ¨submitCommentå‡½æ•°ä¸­è®¾ç½®äº†\r\n        }\r\n    };\r\n\r\n    // å¤„ç†é”®ç›˜äº‹ä»¶\r\n    useEffect(() => {\r\n        const handleKeyDown = (e) => {\r\n            if (e.key === 'Escape' && isCommentsPaneOpen) {\r\n                closeCommentsPane();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [isCommentsPaneOpen]);\r\n\r\n    return (\r\n        <div style={styles.app}>\r\n            <header style={styles.header}>\r\n                <h1 style={styles.headerTitle}>Cultural Events Hong Kong</h1>\r\n            </header>\r\n            \r\n            <main style={styles.main}>\r\n                {/* åœ°å›¾å®¹å™¨ */}\r\n                <div style={styles.mapContainer}>\r\n                    <div ref={mapRef} style={styles.mainMap} />\r\n                </div>\r\n                \r\n                {/* è¯„è®ºå¼¹çª— */}\r\n                <div \r\n                    ref={paneRef}\r\n                    style={styles.commentsPane}\r\n                >\r\n                    <div style={styles.paneHeader}>\r\n                        <div>\r\n                            <h2 style={styles.paneTitle}>{locationName}</h2>\r\n                            {locationName && (\r\n                                <div style={styles.locationName}>\r\n                                    Comments\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <button \r\n                            onClick={closeCommentsPane}\r\n                            style={styles.closeButton}\r\n                            aria-label=\"Close comments pane\"\r\n                        >\r\n                            Ã—\r\n                        </button>\r\n                    </div>\r\n                    \r\n                    <div style={styles.paneContent}>\r\n                        <div style={styles.commentsSection}>\r\n                            <div style={styles.commentsCount}>\r\n                                {comments.length} {comments.length === 1 ? 'Comment' : 'Comments'}\r\n                            </div>\r\n                            \r\n                            {error && (\r\n                                <div style={styles.errorMessage}>\r\n                                    {error}\r\n                                </div>\r\n                            )}\r\n                            \r\n                            <div style={styles.commentsList}>\r\n                                {isLoading ? (\r\n                                    <div style={styles.loadingIndicator}>\r\n                                        Loading comments...\r\n                                    </div>\r\n                                ) : comments.length > 0 ? (\r\n                                    comments.map((comment) => (\r\n                                        <div key={comment.id} style={styles.commentItem}>\r\n                                            <div style={styles.commentHeader}>\r\n                                                <span style={styles.commentAuthor}>\r\n                                                    {comment.username}\r\n                                                </span>\r\n                                                <span style={styles.commentDate}>\r\n                                                    {comment.date}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div style={styles.commentText}>\r\n                                                {comment.text}\r\n                                            </div>\r\n                                        </div>\r\n                                    ))\r\n                                ) : (\r\n                                    <div style={styles.noComments}>\r\n                                        No comments yet for this location.\r\n                                        <div style={{ marginTop: '0.5rem', fontSize: '0.8rem' }}>\r\n                                            Be the first to share your experience!\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <div style={styles.addCommentSection}>\r\n                                <div style={styles.commentFormTitle}>\r\n                                    Add a Comment\r\n                                </div>\r\n                                <textarea\r\n                                    value={newComment}\r\n                                    onChange={(e) => setNewComment(e.target.value)}\r\n                                    placeholder=\"Share your thoughts about this venue...\"\r\n                                    style={styles.commentTextarea}\r\n                                    rows=\"3\"\r\n                                    disabled={isLoading}\r\n                                />\r\n                                <button\r\n                                    onClick={handleAddComment}\r\n                                    style={{\r\n                                        ...styles.submitButton,\r\n                                        ...(newComment.trim() === '' || isLoading ? styles.submitButtonDisabled : {})\r\n                                    }}\r\n                                    disabled={newComment.trim() === '' || isLoading}\r\n                                >\r\n                                    {isLoading ? 'Posting...' : 'Post Comment'}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                {/* å åŠ å±‚ï¼ˆç‚¹å‡»å…³é—­å¼¹çª—ï¼‰ */}\r\n                {isCommentsPaneOpen && (\r\n                    <div \r\n                        style={styles.overlay}\r\n                        onClick={closeCommentsPane}\r\n                    />\r\n                )}\r\n            </main>\r\n            \r\n            <footer style={{\r\n                background: '#2c3e50',\r\n                color: 'white',\r\n                textAlign: 'center',\r\n                padding: '1rem',\r\n                fontSize: '0.9rem'\r\n            }}>\r\n                <p>Â© 2024 Cultural Events Web Application | Click on any marker to view and post comments</p>\r\n            </footer>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}