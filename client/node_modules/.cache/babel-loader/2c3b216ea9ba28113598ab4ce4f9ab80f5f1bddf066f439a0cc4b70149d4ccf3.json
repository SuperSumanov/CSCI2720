{"ast":null,"code":"// import React, { useState, useEffect, useRef } from 'react';\n// import L from 'leaflet';\n// import 'leaflet/dist/leaflet.css';\n\n// const MapPage = () => {\n//     const [selectedLocation, setSelectedLocation] = useState(null);\n//     const [locationName, setLocationName] = useState('');\n//     const [comments, setComments] = useState([]);\n//     const [newComment, setNewComment] = useState('');\n//     const [isCommentsPaneOpen, setIsCommentsPaneOpen] = useState(false);\n//     const [isLoading, setIsLoading] = useState(false);\n//     const [error, setError] = useState('');\n\n//     const mapRef = useRef(null);\n//     const mapInstanceRef = useRef(null);\n//     const markersRef = useRef([]);\n//     const paneRef = useRef(null);\n\n//     // Ê®°Êãü‰ΩçÁΩÆÊï∞ÊçÆÔºàÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•‰ªéAPIËé∑ÂèñÔºâ\n//     const mockLocations = [\n//         { id: '3110031', name: 'Hong Kong Cultural Centre', latitude: 22.2933, longitude: 114.1699 },\n//         { id: '3110267', name: 'Hong Kong City Hall', latitude: 22.2819, longitude: 114.1586 },\n//         { id: '3110565', name: 'Ko Shan Theatre', latitude: 22.3367, longitude: 114.1875 },\n//         { id: '35510043', name: 'Kwai Tsing Theatre', latitude: 22.3536, longitude: 114.1011 },\n//         { id: '35510044', name: 'Sai Wan Ho Civic Centre', latitude: 22.2822, longitude: 114.2292 },\n//         { id: '35511887', name: 'Ngau Chi Wan Civic Centre', latitude: 22.3358, longitude: 114.2092 },\n//         { id: '35517396', name: 'Yuen Long Theatre', latitude: 22.4450, longitude: 114.0269 },\n//         { id: '35517495', name: 'Tuen Mun Town Hall', latitude: 22.3958, longitude: 113.9731 },\n//         { id: '36310304', name: 'Sha Tin Town Hall', latitude: 22.3808, longitude: 114.1869 },\n//         { id: '36310566', name: 'Tai Po Civic Centre', latitude: 22.4481, longitude: 114.1669 }\n//     ];\n\n//     // APIÂü∫Á°ÄURL - Âú®ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÔºåËøô‰∏™Â∫îËØ•‰ªéÁéØÂ¢ÉÂèòÈáè‰∏≠Ëé∑Âèñ\n//     const API_BASE_URL = 'http://localhost:3000';\n\n//     // Ê†∑ÂºèÂÆö‰πâ\n//     const styles = {\n//         app: {\n//             display: 'flex',\n//             flexDirection: 'column',\n//             minHeight: '100vh',\n//             margin: 0,\n//             padding: 0,\n//             boxSizing: 'border-box',\n//             fontFamily: \"'Arial', sans-serif\",\n//             lineHeight: 1.6,\n//             color: '#333',\n//             position: 'relative'\n//         },\n\n//         header: {\n//             background: 'linear-gradient(135deg, #2c3e50, #3498db)',\n//             color: 'white',\n//             padding: '1rem 2rem',\n//             boxShadow: '0 2px 10px rgba(0, 0, 0, 0.1)',\n//             zIndex: 1000,\n//             display: 'flex',\n//             justifyContent: 'space-between',\n//             alignItems: 'center'\n//         },\n\n//         headerTitle: {\n//             fontSize: '1.5rem',\n//             margin: 0\n//         },\n\n//         main: {\n//             flex: 1,\n//             display: 'flex',\n//             position: 'relative',\n//             overflow: 'hidden'\n//         },\n\n//         mapContainer: {\n//             flex: 1,\n//             position: 'relative',\n//             zIndex: 1\n//         },\n\n//         mainMap: {\n//             width: '100%',\n//             height: '100%'\n//         },\n\n//         // ËØÑËÆ∫ÂºπÁ™óÊ†∑Âºè\n//         commentsPane: {\n//             position: 'absolute',\n//             top: 0,\n//             left: 0,\n//             width: '350px',\n//             height: '100%',\n//             background: 'white',\n//             boxShadow: '2px 0 20px rgba(0, 0, 0, 0.15)',\n//             zIndex: 100,\n//             transform: isCommentsPaneOpen ? 'translateX(0)' : 'translateX(-100%)',\n//             transition: 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n//             display: 'flex',\n//             flexDirection: 'column',\n//             overflow: 'hidden'\n//         },\n\n//         paneHeader: {\n//             padding: '1.5rem',\n//             background: 'linear-gradient(135deg, #2c3e50, #3498db)',\n//             color: 'white',\n//             display: 'flex',\n//             justifyContent: 'space-between',\n//             alignItems: 'center',\n//             flexShrink: 0\n//         },\n\n//         paneTitle: {\n//             margin: 0,\n//             fontSize: '1.1rem',\n//             fontWeight: '500'\n//         },\n\n//         locationName: {\n//             fontSize: '0.9rem',\n//             opacity: 0.9,\n//             marginTop: '0.25rem'\n//         },\n\n//         closeButton: {\n//             background: 'rgba(255, 255, 255, 0.2)',\n//             border: 'none',\n//             color: 'white',\n//             width: '32px',\n//             height: '32px',\n//             borderRadius: '50%',\n//             cursor: 'pointer',\n//             display: 'flex',\n//             alignItems: 'center',\n//             justifyContent: 'center',\n//             transition: 'background 0.3s',\n//             fontSize: '1.2rem',\n//             flexShrink: 0\n//         },\n\n//         paneContent: {\n//             flex: 1,\n//             overflowY: 'auto',\n//             padding: '1.5rem',\n//             display: 'flex',\n//             flexDirection: 'column'\n//         },\n\n//         // ËØÑËÆ∫ÈÉ®ÂàÜ\n//         commentsSection: {\n//             flex: 1,\n//             display: 'flex',\n//             flexDirection: 'column'\n//         },\n\n//         commentsCount: {\n//             color: '#2c3e50',\n//             marginBottom: '1rem',\n//             paddingBottom: '0.75rem',\n//             borderBottom: '2px solid #eee',\n//             fontSize: '0.9rem',\n//             fontWeight: '500'\n//         },\n\n//         commentsList: {\n//             flex: 1,\n//             overflowY: 'auto',\n//             marginBottom: '1.5rem'\n//         },\n\n//         commentItem: {\n//             padding: '1rem',\n//             borderBottom: '1px solid #f0f0f0',\n//             background: '#fafafa',\n//             borderRadius: '8px',\n//             marginBottom: '0.75rem'\n//         },\n\n//         commentHeader: {\n//             display: 'flex',\n//             justifyContent: 'space-between',\n//             alignItems: 'center',\n//             marginBottom: '0.5rem'\n//         },\n\n//         commentAuthor: {\n//             fontWeight: 'bold',\n//             color: '#2c3e50',\n//             fontSize: '0.9rem'\n//         },\n\n//         commentDate: {\n//             color: '#888',\n//             fontSize: '0.8rem'\n//         },\n\n//         commentText: {\n//             color: '#555',\n//             lineHeight: 1.5,\n//             fontSize: '0.9rem'\n//         },\n\n//         noComments: {\n//             color: '#999',\n//             textAlign: 'center',\n//             padding: '3rem 1rem',\n//             fontStyle: 'italic',\n//             fontSize: '0.9rem'\n//         },\n\n//         // Ê∑ªÂä†ËØÑËÆ∫Ë°®Âçï\n//         addCommentSection: {\n//             background: '#f8f9fa',\n//             padding: '1.5rem',\n//             borderRadius: '8px',\n//             border: '1px solid #eaeaea',\n//             flexShrink: 0\n//         },\n\n//         commentFormTitle: {\n//             color: '#2c3e50',\n//             marginBottom: '1rem',\n//             fontSize: '0.9rem',\n//             fontWeight: '500'\n//         },\n\n//         commentTextarea: {\n//             width: '100%',\n//             padding: '0.75rem',\n//             border: '1px solid #ddd',\n//             borderRadius: '6px',\n//             resize: 'vertical',\n//             marginBottom: '1rem',\n//             fontFamily: 'inherit',\n//             fontSize: '0.9rem',\n//             minHeight: '80px',\n//             transition: 'border-color 0.3s',\n//             boxSizing: 'border-box'\n//         },\n\n//         submitButton: {\n//             background: '#3498db',\n//             color: 'white',\n//             border: 'none',\n//             padding: '0.75rem 1.5rem',\n//             borderRadius: '6px',\n//             cursor: 'pointer',\n//             fontSize: '0.9rem',\n//             transition: 'background 0.3s',\n//             width: '100%',\n//             fontWeight: '500'\n//         },\n\n//         submitButtonHover: {\n//             background: '#2980b9'\n//         },\n\n//         submitButtonDisabled: {\n//             background: '#bdc3c7',\n//             cursor: 'not-allowed'\n//         },\n\n//         errorMessage: {\n//             color: '#e74c3c',\n//             fontSize: '0.9rem',\n//             marginBottom: '1rem',\n//             padding: '0.5rem',\n//             background: '#fdf2f2',\n//             borderRadius: '4px',\n//             border: '1px solid #f8d7da'\n//         },\n\n//         loadingIndicator: {\n//             textAlign: 'center',\n//             padding: '2rem',\n//             color: '#666',\n//             fontSize: '0.9rem'\n//         },\n\n//         // Âè†Âä†Â±Ç\n//         overlay: {\n//             position: 'absolute',\n//             top: 0,\n//             left: 0,\n//             right: 0,\n//             bottom: 0,\n//             background: 'rgba(0, 0, 0, 0.4)',\n//             zIndex: 50,\n//             opacity: isCommentsPaneOpen ? 1 : 0,\n//             visibility: isCommentsPaneOpen ? 'visible' : 'hidden',\n//             transition: 'opacity 0.3s, visibility 0.3s',\n//             cursor: 'pointer'\n//         },\n\n//         // ÂìçÂ∫îÂºè\n//         '@media (max-width: 768px)': {\n//             commentsPane: {\n//                 width: '100%',\n//                 maxWidth: '100%'\n//             }\n//         }\n//     };\n\n//     // ÂàùÂßãÂåñÂú∞Âõæ\n//     useEffect(() => {\n//         const initMap = () => {\n//             if (!mapInstanceRef.current && mapRef.current) {\n//                 mapInstanceRef.current = L.map(mapRef.current).setView([22.3193, 114.1694], 12);\n\n//                 L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n//                     attribution: '&copy; OpenStreetMap contributors',\n//                     maxZoom: 18\n//                 }).addTo(mapInstanceRef.current);\n\n//                 addMarkersToMap(mockLocations);\n//             }\n//         };\n\n//         initMap();\n\n//         // Â§ÑÁêÜÊµèËßàÂô®ÂéÜÂè≤\n//         const handlePopState = () => {\n//             const url = new URL(window.location.href);\n//             const locationId = url.searchParams.get('location');\n\n//             if (locationId) {\n//                 handleMarkerClick(locationId, false);\n//             } else {\n//                 closeCommentsPane();\n//             }\n//         };\n\n//         window.addEventListener('popstate', handlePopState);\n\n//         // ÂàùÂßãURLÂ§ÑÁêÜ\n//         const url = new URL(window.location.href);\n//         const initialLocationId = url.searchParams.get('location');\n//         if (initialLocationId) {\n//             handleMarkerClick(initialLocationId, false);\n//         }\n\n//         return () => {\n//             if (mapInstanceRef.current) {\n//                 mapInstanceRef.current.remove();\n//                 mapInstanceRef.current = null;\n//             }\n//             window.removeEventListener('popstate', handlePopState);\n//         };\n//     }, []);\n\n//     // Ê∑ªÂä†Ê†áËÆ∞Âà∞Âú∞Âõæ\n//     const addMarkersToMap = (locationsData) => {\n//         if (!mapInstanceRef.current) return;\n\n//         // Ê∏ÖÈô§Áé∞ÊúâÊ†áËÆ∞\n//         markersRef.current.forEach(marker => {\n//             if (marker && mapInstanceRef.current) {\n//                 mapInstanceRef.current.removeLayer(marker);\n//             }\n//         });\n//         markersRef.current = [];\n\n//         // ÂàõÂª∫Ëá™ÂÆö‰πâÂõæÊ†á\n//         const createCustomIcon = (isSelected = false) => {\n//             return L.divIcon({\n//                 className: 'custom-marker',\n//                 html: `\n//                     <div style=\"\n//                         background: ${isSelected ? '#e74c3c' : '#3498db'};\n//                         width: 36px;\n//                         height: 36px;\n//                         border-radius: 50%;\n//                         border: 3px solid white;\n//                         box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n//                         display: flex;\n//                         align-items: center;\n//                         justify-content: center;\n//                         color: white;\n//                         font-weight: bold;\n//                         font-size: 16px;\n//                         transition: all 0.3s;\n//                     \">\n//                         <div style=\"transform: translateY(-1px)\">üìç</div>\n//                     </div>\n//                 `,\n//                 iconSize: [36, 36],\n//                 iconAnchor: [18, 36]\n//             });\n//         };\n\n//         // Ê∑ªÂä†Êñ∞Ê†áËÆ∞\n//         locationsData.forEach(location => {\n//             const isSelected = selectedLocation === location.id;\n//             const marker = L.marker([location.latitude, location.longitude], {\n//                 icon: createCustomIcon(isSelected)\n//             })\n//                 .addTo(mapInstanceRef.current)\n//                 .bindTooltip(location.name, {\n//                     direction: 'top',\n//                     offset: [0, -18],\n//                     opacity: 0.9,\n//                     className: 'map-tooltip'\n//                 });\n\n//             // Ê†áËÆ∞ÁÇπÂáª‰∫ã‰ª∂\n//             marker.on('click', () => {\n//                 handleMarkerClick(location.id, true);\n//             });\n\n//             markersRef.current.push(marker);\n//         });\n//     };\n\n//     // ‰ªéÂêéÁ´ØAPIËé∑ÂèñËØÑËÆ∫\n//     const fetchComments = async (locationId) => {\n//         setIsLoading(true);\n//         setError('');\n\n//         try {\n//             // Ë∞ÉÁî®ÂêéÁ´ØAPIËé∑ÂèñÊüê‰∏™Âú∞ÁÇπÁöÑÊâÄÊúâËØÑËÆ∫\n//             const response = await fetch(`${API_BASE_URL}/comment/loc-all/${locationId}`);\n\n//             if (!response.ok) {\n//                 throw new Error(`Failed to fetch comments: ${response.status} ${response.statusText}`);\n//             }\n\n//             const commentsData = await response.json();\n\n//             // Â∞ÜÂêéÁ´ØÊï∞ÊçÆËΩ¨Êç¢‰∏∫ÂâçÁ´ØÈúÄË¶ÅÁöÑÊ†ºÂºè\n//             const formattedComments = commentsData.map(comment => ({\n//                 id: comment.commentId || comment._id,\n//                 locationId: comment.locationId,\n//                 username: comment.username || 'Anonymous', // Ê†πÊçÆÂêéÁ´ØËøîÂõûÁöÑÂÆûÈôÖÂ≠óÊÆµË∞ÉÊï¥\n//                 text: comment.content,\n//                 date: new Date(comment.timestamp).toLocaleDateString('en-US', { \n//                     year: 'numeric', \n//                     month: 'short', \n//                     day: 'numeric' \n//                 }),\n//                 timestamp: comment.timestamp,\n//                 userId: comment.userId\n//             }));\n\n//             return formattedComments;\n//         } catch (error) {\n//             console.error('Error fetching comments:', error);\n//             setError(`Failed to load comments: ${error.message}`);\n//             return [];\n//         } finally {\n//             setIsLoading(false);\n//         }\n//     };\n\n//     // ÂêëÂêéÁ´ØAPIÊèê‰∫§ËØÑËÆ∫\n//     const submitComment = async (commentData) => {\n//         setIsLoading(true);\n//         setError('');\n\n//         try {\n//             // Ëé∑ÂèñËÆ§ËØÅtokenÔºàÂÅáËÆæÂ≠òÂÇ®Âú®localStorage‰∏≠Ôºâ\n//             const token = localStorage.getItem('authToken');\n\n//             const response = await fetch(`${API_BASE_URL}/comment/send`, {\n//                 method: 'POST',\n//                 headers: {\n//                     'Content-Type': 'application/json',\n//                     ...(token && { 'Authorization': `Bearer ${token}` })\n//                 },\n//                 body: JSON.stringify({\n//                     locID: commentData.locationId,\n//                     content: commentData.text\n//                 })\n//             });\n\n//             if (!response.ok) {\n//                 const errorData = await response.json().catch(() => ({}));\n//                 throw new Error(errorData.error || `Failed to submit comment: ${response.status}`);\n//             }\n\n//             const result = await response.json();\n\n//             // ËøîÂõûÊñ∞ÂàõÂª∫ÁöÑËØÑËÆ∫\n//             return {\n//                 id: result.comment._id || Date.now(),\n//                 locationId: commentData.locationId,\n//                 username: commentData.username,\n//                 text: commentData.text,\n//                 date: new Date().toLocaleDateString('en-US', { \n//                     year: 'numeric', \n//                     month: 'short', \n//                     day: 'numeric' \n//                 }),\n//                 timestamp: new Date().toISOString()\n//             };\n//         } catch (error) {\n//             console.error('Error submitting comment:', error);\n//             setError(`Failed to submit comment: ${error.message}`);\n//             throw error;\n//         } finally {\n//             setIsLoading(false);\n//         }\n//     };\n\n//     // Â§ÑÁêÜÊ†áËÆ∞ÁÇπÂáª\n//     const handleMarkerClick = async (locationId, pushHistory = true) => {\n//         // ÊâæÂà∞‰ΩçÁΩÆ‰ø°ÊÅØ\n//         const location = mockLocations.find(loc => loc.id === locationId);\n//         if (!location) return;\n\n//         // Êõ¥Êñ∞ÈÄâ‰∏≠ÁöÑ‰ΩçÁΩÆ\n//         setSelectedLocation(locationId);\n//         setLocationName(location.name);\n\n//         // ‰ªéAPIÂä†ËΩΩËØÑËÆ∫\n//         const locationComments = await fetchComments(locationId);\n//         setComments(locationComments);\n\n//         // ÊâìÂºÄËØÑËÆ∫ÂºπÁ™ó\n//         setIsCommentsPaneOpen(true);\n\n//         // Êõ¥Êñ∞URLÂπ∂Êé®ÂÖ•ÂéÜÂè≤ËÆ∞ÂΩïÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ\n//         if (pushHistory) {\n//             const url = new URL(window.location.href);\n//             url.searchParams.set('location', locationId);\n//             window.history.pushState({ locationId }, '', url);\n//         }\n\n//         // ÈáçÊñ∞Ê∏≤ÊüìÊ†áËÆ∞‰ª•Êõ¥Êñ∞ÈÄâ‰∏≠Áä∂ÊÄÅ\n//         addMarkersToMap(mockLocations);\n\n//         // Â±Ö‰∏≠ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÊ†áËÆ∞\n//         if (mapInstanceRef.current) {\n//             mapInstanceRef.current.setView([location.latitude, location.longitude], 14);\n//         }\n//     };\n\n//     // ÂÖ≥Èó≠ËØÑËÆ∫ÂºπÁ™ó\n//     const closeCommentsPane = () => {\n//         setIsCommentsPaneOpen(false);\n//         setSelectedLocation(null);\n//         setLocationName('');\n//         setComments([]);\n//         setNewComment('');\n//         setError('');\n\n//         // Êõ¥Êñ∞URL\n//         const url = new URL(window.location.href);\n//         url.searchParams.delete('location');\n//         window.history.pushState({}, '', url);\n\n//         // ÈáçÊñ∞Ê∏≤ÊüìÊ†áËÆ∞‰ª•Ê∏ÖÈô§ÈÄâ‰∏≠Áä∂ÊÄÅ\n//         addMarkersToMap(mockLocations);\n\n//         // ÈáçÁΩÆÂú∞ÂõæËßÜÂõæ\n//         if (mapInstanceRef.current) {\n//             mapInstanceRef.current.setView([22.3193, 114.1694], 12);\n//         }\n//     };\n\n//     // Ê∑ªÂä†ËØÑËÆ∫\n//     const handleAddComment = async () => {\n//         if (newComment.trim() === '' || !selectedLocation) return;\n\n//         try {\n//             // Ê®°ÊãüÂΩìÂâçÁî®Êà∑ÔºàÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•‰ªéÁôªÂΩïÁä∂ÊÄÅËé∑ÂèñÔºâ\n//             const currentUser = localStorage.getItem('currentUser') || 'Current User';\n\n//             const commentData = {\n//                 locationId: selectedLocation,\n//                 username: currentUser,\n//                 text: newComment.trim()\n//             };\n\n//             // Êèê‰∫§ËØÑËÆ∫Âà∞ÂêéÁ´ØAPI\n//             const newCommentObj = await submitComment(commentData);\n\n//             // Êõ¥Êñ∞ËØÑËÆ∫ÂàóË°®\n//             setComments(prevComments => [...prevComments, newCommentObj]);\n//             setNewComment('');\n\n//         } catch (error) {\n//             console.error('Failed to add comment:', error);\n//             // ÈîôËØØ‰ø°ÊÅØÂ∑≤ÁªèÂú®submitCommentÂáΩÊï∞‰∏≠ËÆæÁΩÆ‰∫Ü\n//         }\n//     };\n\n//     // Â§ÑÁêÜÈîÆÁõò‰∫ã‰ª∂\n//     useEffect(() => {\n//         const handleKeyDown = (e) => {\n//             if (e.key === 'Escape' && isCommentsPaneOpen) {\n//                 closeCommentsPane();\n//             }\n//         };\n\n//         window.addEventListener('keydown', handleKeyDown);\n//         return () => window.removeEventListener('keydown', handleKeyDown);\n//     }, [isCommentsPaneOpen]);\n\n//     return (\n//         <div style={styles.app}>\n//             <header style={styles.header}>\n//                 <h1 style={styles.headerTitle}>Cultural Events Hong Kong</h1>\n//             </header>\n\n//             <main style={styles.main}>\n//                 {/* Âú∞ÂõæÂÆπÂô® */}\n//                 <div style={styles.mapContainer}>\n//                     <div ref={mapRef} style={styles.mainMap} />\n//                 </div>\n\n//                 {/* ËØÑËÆ∫ÂºπÁ™ó */}\n//                 <div \n//                     ref={paneRef}\n//                     style={styles.commentsPane}\n//                 >\n//                     <div style={styles.paneHeader}>\n//                         <div>\n//                             <h2 style={styles.paneTitle}>{locationName}</h2>\n//                             {locationName && (\n//                                 <div style={styles.locationName}>\n//                                     Comments\n//                                 </div>\n//                             )}\n//                         </div>\n//                         <button \n//                             onClick={closeCommentsPane}\n//                             style={styles.closeButton}\n//                             aria-label=\"Close comments pane\"\n//                         >\n//                             √ó\n//                         </button>\n//                     </div>\n\n//                     <div style={styles.paneContent}>\n//                         <div style={styles.commentsSection}>\n//                             <div style={styles.commentsCount}>\n//                                 {comments.length} {comments.length === 1 ? 'Comment' : 'Comments'}\n//                             </div>\n\n//                             {error && (\n//                                 <div style={styles.errorMessage}>\n//                                     {error}\n//                                 </div>\n//                             )}\n\n//                             <div style={styles.commentsList}>\n//                                 {isLoading ? (\n//                                     <div style={styles.loadingIndicator}>\n//                                         Loading comments...\n//                                     </div>\n//                                 ) : comments.length > 0 ? (\n//                                     comments.map((comment) => (\n//                                         <div key={comment.id} style={styles.commentItem}>\n//                                             <div style={styles.commentHeader}>\n//                                                 <span style={styles.commentAuthor}>\n//                                                     {comment.username}\n//                                                 </span>\n//                                                 <span style={styles.commentDate}>\n//                                                     {comment.date}\n//                                                 </span>\n//                                             </div>\n//                                             <div style={styles.commentText}>\n//                                                 {comment.text}\n//                                             </div>\n//                                         </div>\n//                                     ))\n//                                 ) : (\n//                                     <div style={styles.noComments}>\n//                                         No comments yet for this location.\n//                                         <div style={{ marginTop: '0.5rem', fontSize: '0.8rem' }}>\n//                                             Be the first to share your experience!\n//                                         </div>\n//                                     </div>\n//                                 )}\n//                             </div>\n\n//                             <div style={styles.addCommentSection}>\n//                                 <div style={styles.commentFormTitle}>\n//                                     Add a Comment\n//                                 </div>\n//                                 <textarea\n//                                     value={newComment}\n//                                     onChange={(e) => setNewComment(e.target.value)}\n//                                     placeholder=\"Share your thoughts about this venue...\"\n//                                     style={styles.commentTextarea}\n//                                     rows=\"3\"\n//                                     disabled={isLoading}\n//                                 />\n//                                 <button\n//                                     onClick={handleAddComment}\n//                                     style={{\n//                                         ...styles.submitButton,\n//                                         ...(newComment.trim() === '' || isLoading ? styles.submitButtonDisabled : {})\n//                                     }}\n//                                     disabled={newComment.trim() === '' || isLoading}\n//                                 >\n//                                     {isLoading ? 'Posting...' : 'Post Comment'}\n//                                 </button>\n//                             </div>\n//                         </div>\n//                     </div>\n//                 </div>\n\n//                 {/* Âè†Âä†Â±ÇÔºàÁÇπÂáªÂÖ≥Èó≠ÂºπÁ™óÔºâ */}\n//                 {isCommentsPaneOpen && (\n//                     <div \n//                         style={styles.overlay}\n//                         onClick={closeCommentsPane}\n//                     />\n//                 )}\n//             </main>\n\n//             <footer style={{\n//                 background: '#2c3e50',\n//                 color: 'white',\n//                 textAlign: 'center',\n//                 padding: '1rem',\n//                 fontSize: '0.9rem'\n//             }}>\n//                 <p>¬© 2024 Cultural Events Web Application | Click on any marker to view and post comments</p>\n//             </footer>\n//         </div>\n//     );\n// };\n\n// export default MapPage;","map":{"version":3,"names":[],"sources":["C:/University/CSCI2720/project/CSCI2720/client/src/pages/MapPage.jsx"],"sourcesContent":["// import React, { useState, useEffect, useRef } from 'react';\r\n// import L from 'leaflet';\r\n// import 'leaflet/dist/leaflet.css';\r\n\r\n// const MapPage = () => {\r\n//     const [selectedLocation, setSelectedLocation] = useState(null);\r\n//     const [locationName, setLocationName] = useState('');\r\n//     const [comments, setComments] = useState([]);\r\n//     const [newComment, setNewComment] = useState('');\r\n//     const [isCommentsPaneOpen, setIsCommentsPaneOpen] = useState(false);\r\n//     const [isLoading, setIsLoading] = useState(false);\r\n//     const [error, setError] = useState('');\r\n    \r\n//     const mapRef = useRef(null);\r\n//     const mapInstanceRef = useRef(null);\r\n//     const markersRef = useRef([]);\r\n//     const paneRef = useRef(null);\r\n\r\n//     // Ê®°Êãü‰ΩçÁΩÆÊï∞ÊçÆÔºàÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•‰ªéAPIËé∑ÂèñÔºâ\r\n//     const mockLocations = [\r\n//         { id: '3110031', name: 'Hong Kong Cultural Centre', latitude: 22.2933, longitude: 114.1699 },\r\n//         { id: '3110267', name: 'Hong Kong City Hall', latitude: 22.2819, longitude: 114.1586 },\r\n//         { id: '3110565', name: 'Ko Shan Theatre', latitude: 22.3367, longitude: 114.1875 },\r\n//         { id: '35510043', name: 'Kwai Tsing Theatre', latitude: 22.3536, longitude: 114.1011 },\r\n//         { id: '35510044', name: 'Sai Wan Ho Civic Centre', latitude: 22.2822, longitude: 114.2292 },\r\n//         { id: '35511887', name: 'Ngau Chi Wan Civic Centre', latitude: 22.3358, longitude: 114.2092 },\r\n//         { id: '35517396', name: 'Yuen Long Theatre', latitude: 22.4450, longitude: 114.0269 },\r\n//         { id: '35517495', name: 'Tuen Mun Town Hall', latitude: 22.3958, longitude: 113.9731 },\r\n//         { id: '36310304', name: 'Sha Tin Town Hall', latitude: 22.3808, longitude: 114.1869 },\r\n//         { id: '36310566', name: 'Tai Po Civic Centre', latitude: 22.4481, longitude: 114.1669 }\r\n//     ];\r\n\r\n//     // APIÂü∫Á°ÄURL - Âú®ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÔºåËøô‰∏™Â∫îËØ•‰ªéÁéØÂ¢ÉÂèòÈáè‰∏≠Ëé∑Âèñ\r\n//     const API_BASE_URL = 'http://localhost:3000';\r\n\r\n//     // Ê†∑ÂºèÂÆö‰πâ\r\n//     const styles = {\r\n//         app: {\r\n//             display: 'flex',\r\n//             flexDirection: 'column',\r\n//             minHeight: '100vh',\r\n//             margin: 0,\r\n//             padding: 0,\r\n//             boxSizing: 'border-box',\r\n//             fontFamily: \"'Arial', sans-serif\",\r\n//             lineHeight: 1.6,\r\n//             color: '#333',\r\n//             position: 'relative'\r\n//         },\r\n        \r\n//         header: {\r\n//             background: 'linear-gradient(135deg, #2c3e50, #3498db)',\r\n//             color: 'white',\r\n//             padding: '1rem 2rem',\r\n//             boxShadow: '0 2px 10px rgba(0, 0, 0, 0.1)',\r\n//             zIndex: 1000,\r\n//             display: 'flex',\r\n//             justifyContent: 'space-between',\r\n//             alignItems: 'center'\r\n//         },\r\n        \r\n//         headerTitle: {\r\n//             fontSize: '1.5rem',\r\n//             margin: 0\r\n//         },\r\n        \r\n//         main: {\r\n//             flex: 1,\r\n//             display: 'flex',\r\n//             position: 'relative',\r\n//             overflow: 'hidden'\r\n//         },\r\n        \r\n//         mapContainer: {\r\n//             flex: 1,\r\n//             position: 'relative',\r\n//             zIndex: 1\r\n//         },\r\n        \r\n//         mainMap: {\r\n//             width: '100%',\r\n//             height: '100%'\r\n//         },\r\n        \r\n//         // ËØÑËÆ∫ÂºπÁ™óÊ†∑Âºè\r\n//         commentsPane: {\r\n//             position: 'absolute',\r\n//             top: 0,\r\n//             left: 0,\r\n//             width: '350px',\r\n//             height: '100%',\r\n//             background: 'white',\r\n//             boxShadow: '2px 0 20px rgba(0, 0, 0, 0.15)',\r\n//             zIndex: 100,\r\n//             transform: isCommentsPaneOpen ? 'translateX(0)' : 'translateX(-100%)',\r\n//             transition: 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\r\n//             display: 'flex',\r\n//             flexDirection: 'column',\r\n//             overflow: 'hidden'\r\n//         },\r\n        \r\n//         paneHeader: {\r\n//             padding: '1.5rem',\r\n//             background: 'linear-gradient(135deg, #2c3e50, #3498db)',\r\n//             color: 'white',\r\n//             display: 'flex',\r\n//             justifyContent: 'space-between',\r\n//             alignItems: 'center',\r\n//             flexShrink: 0\r\n//         },\r\n        \r\n//         paneTitle: {\r\n//             margin: 0,\r\n//             fontSize: '1.1rem',\r\n//             fontWeight: '500'\r\n//         },\r\n        \r\n//         locationName: {\r\n//             fontSize: '0.9rem',\r\n//             opacity: 0.9,\r\n//             marginTop: '0.25rem'\r\n//         },\r\n        \r\n//         closeButton: {\r\n//             background: 'rgba(255, 255, 255, 0.2)',\r\n//             border: 'none',\r\n//             color: 'white',\r\n//             width: '32px',\r\n//             height: '32px',\r\n//             borderRadius: '50%',\r\n//             cursor: 'pointer',\r\n//             display: 'flex',\r\n//             alignItems: 'center',\r\n//             justifyContent: 'center',\r\n//             transition: 'background 0.3s',\r\n//             fontSize: '1.2rem',\r\n//             flexShrink: 0\r\n//         },\r\n        \r\n//         paneContent: {\r\n//             flex: 1,\r\n//             overflowY: 'auto',\r\n//             padding: '1.5rem',\r\n//             display: 'flex',\r\n//             flexDirection: 'column'\r\n//         },\r\n        \r\n//         // ËØÑËÆ∫ÈÉ®ÂàÜ\r\n//         commentsSection: {\r\n//             flex: 1,\r\n//             display: 'flex',\r\n//             flexDirection: 'column'\r\n//         },\r\n        \r\n//         commentsCount: {\r\n//             color: '#2c3e50',\r\n//             marginBottom: '1rem',\r\n//             paddingBottom: '0.75rem',\r\n//             borderBottom: '2px solid #eee',\r\n//             fontSize: '0.9rem',\r\n//             fontWeight: '500'\r\n//         },\r\n        \r\n//         commentsList: {\r\n//             flex: 1,\r\n//             overflowY: 'auto',\r\n//             marginBottom: '1.5rem'\r\n//         },\r\n        \r\n//         commentItem: {\r\n//             padding: '1rem',\r\n//             borderBottom: '1px solid #f0f0f0',\r\n//             background: '#fafafa',\r\n//             borderRadius: '8px',\r\n//             marginBottom: '0.75rem'\r\n//         },\r\n        \r\n//         commentHeader: {\r\n//             display: 'flex',\r\n//             justifyContent: 'space-between',\r\n//             alignItems: 'center',\r\n//             marginBottom: '0.5rem'\r\n//         },\r\n        \r\n//         commentAuthor: {\r\n//             fontWeight: 'bold',\r\n//             color: '#2c3e50',\r\n//             fontSize: '0.9rem'\r\n//         },\r\n        \r\n//         commentDate: {\r\n//             color: '#888',\r\n//             fontSize: '0.8rem'\r\n//         },\r\n        \r\n//         commentText: {\r\n//             color: '#555',\r\n//             lineHeight: 1.5,\r\n//             fontSize: '0.9rem'\r\n//         },\r\n        \r\n//         noComments: {\r\n//             color: '#999',\r\n//             textAlign: 'center',\r\n//             padding: '3rem 1rem',\r\n//             fontStyle: 'italic',\r\n//             fontSize: '0.9rem'\r\n//         },\r\n        \r\n//         // Ê∑ªÂä†ËØÑËÆ∫Ë°®Âçï\r\n//         addCommentSection: {\r\n//             background: '#f8f9fa',\r\n//             padding: '1.5rem',\r\n//             borderRadius: '8px',\r\n//             border: '1px solid #eaeaea',\r\n//             flexShrink: 0\r\n//         },\r\n        \r\n//         commentFormTitle: {\r\n//             color: '#2c3e50',\r\n//             marginBottom: '1rem',\r\n//             fontSize: '0.9rem',\r\n//             fontWeight: '500'\r\n//         },\r\n        \r\n//         commentTextarea: {\r\n//             width: '100%',\r\n//             padding: '0.75rem',\r\n//             border: '1px solid #ddd',\r\n//             borderRadius: '6px',\r\n//             resize: 'vertical',\r\n//             marginBottom: '1rem',\r\n//             fontFamily: 'inherit',\r\n//             fontSize: '0.9rem',\r\n//             minHeight: '80px',\r\n//             transition: 'border-color 0.3s',\r\n//             boxSizing: 'border-box'\r\n//         },\r\n        \r\n//         submitButton: {\r\n//             background: '#3498db',\r\n//             color: 'white',\r\n//             border: 'none',\r\n//             padding: '0.75rem 1.5rem',\r\n//             borderRadius: '6px',\r\n//             cursor: 'pointer',\r\n//             fontSize: '0.9rem',\r\n//             transition: 'background 0.3s',\r\n//             width: '100%',\r\n//             fontWeight: '500'\r\n//         },\r\n        \r\n//         submitButtonHover: {\r\n//             background: '#2980b9'\r\n//         },\r\n        \r\n//         submitButtonDisabled: {\r\n//             background: '#bdc3c7',\r\n//             cursor: 'not-allowed'\r\n//         },\r\n        \r\n//         errorMessage: {\r\n//             color: '#e74c3c',\r\n//             fontSize: '0.9rem',\r\n//             marginBottom: '1rem',\r\n//             padding: '0.5rem',\r\n//             background: '#fdf2f2',\r\n//             borderRadius: '4px',\r\n//             border: '1px solid #f8d7da'\r\n//         },\r\n        \r\n//         loadingIndicator: {\r\n//             textAlign: 'center',\r\n//             padding: '2rem',\r\n//             color: '#666',\r\n//             fontSize: '0.9rem'\r\n//         },\r\n        \r\n//         // Âè†Âä†Â±Ç\r\n//         overlay: {\r\n//             position: 'absolute',\r\n//             top: 0,\r\n//             left: 0,\r\n//             right: 0,\r\n//             bottom: 0,\r\n//             background: 'rgba(0, 0, 0, 0.4)',\r\n//             zIndex: 50,\r\n//             opacity: isCommentsPaneOpen ? 1 : 0,\r\n//             visibility: isCommentsPaneOpen ? 'visible' : 'hidden',\r\n//             transition: 'opacity 0.3s, visibility 0.3s',\r\n//             cursor: 'pointer'\r\n//         },\r\n        \r\n//         // ÂìçÂ∫îÂºè\r\n//         '@media (max-width: 768px)': {\r\n//             commentsPane: {\r\n//                 width: '100%',\r\n//                 maxWidth: '100%'\r\n//             }\r\n//         }\r\n//     };\r\n\r\n//     // ÂàùÂßãÂåñÂú∞Âõæ\r\n//     useEffect(() => {\r\n//         const initMap = () => {\r\n//             if (!mapInstanceRef.current && mapRef.current) {\r\n//                 mapInstanceRef.current = L.map(mapRef.current).setView([22.3193, 114.1694], 12);\r\n                \r\n//                 L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n//                     attribution: '&copy; OpenStreetMap contributors',\r\n//                     maxZoom: 18\r\n//                 }).addTo(mapInstanceRef.current);\r\n                \r\n//                 addMarkersToMap(mockLocations);\r\n//             }\r\n//         };\r\n\r\n//         initMap();\r\n\r\n//         // Â§ÑÁêÜÊµèËßàÂô®ÂéÜÂè≤\r\n//         const handlePopState = () => {\r\n//             const url = new URL(window.location.href);\r\n//             const locationId = url.searchParams.get('location');\r\n            \r\n//             if (locationId) {\r\n//                 handleMarkerClick(locationId, false);\r\n//             } else {\r\n//                 closeCommentsPane();\r\n//             }\r\n//         };\r\n\r\n//         window.addEventListener('popstate', handlePopState);\r\n        \r\n//         // ÂàùÂßãURLÂ§ÑÁêÜ\r\n//         const url = new URL(window.location.href);\r\n//         const initialLocationId = url.searchParams.get('location');\r\n//         if (initialLocationId) {\r\n//             handleMarkerClick(initialLocationId, false);\r\n//         }\r\n\r\n//         return () => {\r\n//             if (mapInstanceRef.current) {\r\n//                 mapInstanceRef.current.remove();\r\n//                 mapInstanceRef.current = null;\r\n//             }\r\n//             window.removeEventListener('popstate', handlePopState);\r\n//         };\r\n//     }, []);\r\n\r\n//     // Ê∑ªÂä†Ê†áËÆ∞Âà∞Âú∞Âõæ\r\n//     const addMarkersToMap = (locationsData) => {\r\n//         if (!mapInstanceRef.current) return;\r\n\r\n//         // Ê∏ÖÈô§Áé∞ÊúâÊ†áËÆ∞\r\n//         markersRef.current.forEach(marker => {\r\n//             if (marker && mapInstanceRef.current) {\r\n//                 mapInstanceRef.current.removeLayer(marker);\r\n//             }\r\n//         });\r\n//         markersRef.current = [];\r\n\r\n//         // ÂàõÂª∫Ëá™ÂÆö‰πâÂõæÊ†á\r\n//         const createCustomIcon = (isSelected = false) => {\r\n//             return L.divIcon({\r\n//                 className: 'custom-marker',\r\n//                 html: `\r\n//                     <div style=\"\r\n//                         background: ${isSelected ? '#e74c3c' : '#3498db'};\r\n//                         width: 36px;\r\n//                         height: 36px;\r\n//                         border-radius: 50%;\r\n//                         border: 3px solid white;\r\n//                         box-shadow: 0 2px 8px rgba(0,0,0,0.3);\r\n//                         display: flex;\r\n//                         align-items: center;\r\n//                         justify-content: center;\r\n//                         color: white;\r\n//                         font-weight: bold;\r\n//                         font-size: 16px;\r\n//                         transition: all 0.3s;\r\n//                     \">\r\n//                         <div style=\"transform: translateY(-1px)\">üìç</div>\r\n//                     </div>\r\n//                 `,\r\n//                 iconSize: [36, 36],\r\n//                 iconAnchor: [18, 36]\r\n//             });\r\n//         };\r\n\r\n//         // Ê∑ªÂä†Êñ∞Ê†áËÆ∞\r\n//         locationsData.forEach(location => {\r\n//             const isSelected = selectedLocation === location.id;\r\n//             const marker = L.marker([location.latitude, location.longitude], {\r\n//                 icon: createCustomIcon(isSelected)\r\n//             })\r\n//                 .addTo(mapInstanceRef.current)\r\n//                 .bindTooltip(location.name, {\r\n//                     direction: 'top',\r\n//                     offset: [0, -18],\r\n//                     opacity: 0.9,\r\n//                     className: 'map-tooltip'\r\n//                 });\r\n            \r\n//             // Ê†áËÆ∞ÁÇπÂáª‰∫ã‰ª∂\r\n//             marker.on('click', () => {\r\n//                 handleMarkerClick(location.id, true);\r\n//             });\r\n\r\n//             markersRef.current.push(marker);\r\n//         });\r\n//     };\r\n\r\n//     // ‰ªéÂêéÁ´ØAPIËé∑ÂèñËØÑËÆ∫\r\n//     const fetchComments = async (locationId) => {\r\n//         setIsLoading(true);\r\n//         setError('');\r\n        \r\n//         try {\r\n//             // Ë∞ÉÁî®ÂêéÁ´ØAPIËé∑ÂèñÊüê‰∏™Âú∞ÁÇπÁöÑÊâÄÊúâËØÑËÆ∫\r\n//             const response = await fetch(`${API_BASE_URL}/comment/loc-all/${locationId}`);\r\n            \r\n//             if (!response.ok) {\r\n//                 throw new Error(`Failed to fetch comments: ${response.status} ${response.statusText}`);\r\n//             }\r\n            \r\n//             const commentsData = await response.json();\r\n            \r\n//             // Â∞ÜÂêéÁ´ØÊï∞ÊçÆËΩ¨Êç¢‰∏∫ÂâçÁ´ØÈúÄË¶ÅÁöÑÊ†ºÂºè\r\n//             const formattedComments = commentsData.map(comment => ({\r\n//                 id: comment.commentId || comment._id,\r\n//                 locationId: comment.locationId,\r\n//                 username: comment.username || 'Anonymous', // Ê†πÊçÆÂêéÁ´ØËøîÂõûÁöÑÂÆûÈôÖÂ≠óÊÆµË∞ÉÊï¥\r\n//                 text: comment.content,\r\n//                 date: new Date(comment.timestamp).toLocaleDateString('en-US', { \r\n//                     year: 'numeric', \r\n//                     month: 'short', \r\n//                     day: 'numeric' \r\n//                 }),\r\n//                 timestamp: comment.timestamp,\r\n//                 userId: comment.userId\r\n//             }));\r\n            \r\n//             return formattedComments;\r\n//         } catch (error) {\r\n//             console.error('Error fetching comments:', error);\r\n//             setError(`Failed to load comments: ${error.message}`);\r\n//             return [];\r\n//         } finally {\r\n//             setIsLoading(false);\r\n//         }\r\n//     };\r\n\r\n//     // ÂêëÂêéÁ´ØAPIÊèê‰∫§ËØÑËÆ∫\r\n//     const submitComment = async (commentData) => {\r\n//         setIsLoading(true);\r\n//         setError('');\r\n        \r\n//         try {\r\n//             // Ëé∑ÂèñËÆ§ËØÅtokenÔºàÂÅáËÆæÂ≠òÂÇ®Âú®localStorage‰∏≠Ôºâ\r\n//             const token = localStorage.getItem('authToken');\r\n            \r\n//             const response = await fetch(`${API_BASE_URL}/comment/send`, {\r\n//                 method: 'POST',\r\n//                 headers: {\r\n//                     'Content-Type': 'application/json',\r\n//                     ...(token && { 'Authorization': `Bearer ${token}` })\r\n//                 },\r\n//                 body: JSON.stringify({\r\n//                     locID: commentData.locationId,\r\n//                     content: commentData.text\r\n//                 })\r\n//             });\r\n            \r\n//             if (!response.ok) {\r\n//                 const errorData = await response.json().catch(() => ({}));\r\n//                 throw new Error(errorData.error || `Failed to submit comment: ${response.status}`);\r\n//             }\r\n            \r\n//             const result = await response.json();\r\n            \r\n//             // ËøîÂõûÊñ∞ÂàõÂª∫ÁöÑËØÑËÆ∫\r\n//             return {\r\n//                 id: result.comment._id || Date.now(),\r\n//                 locationId: commentData.locationId,\r\n//                 username: commentData.username,\r\n//                 text: commentData.text,\r\n//                 date: new Date().toLocaleDateString('en-US', { \r\n//                     year: 'numeric', \r\n//                     month: 'short', \r\n//                     day: 'numeric' \r\n//                 }),\r\n//                 timestamp: new Date().toISOString()\r\n//             };\r\n//         } catch (error) {\r\n//             console.error('Error submitting comment:', error);\r\n//             setError(`Failed to submit comment: ${error.message}`);\r\n//             throw error;\r\n//         } finally {\r\n//             setIsLoading(false);\r\n//         }\r\n//     };\r\n\r\n//     // Â§ÑÁêÜÊ†áËÆ∞ÁÇπÂáª\r\n//     const handleMarkerClick = async (locationId, pushHistory = true) => {\r\n//         // ÊâæÂà∞‰ΩçÁΩÆ‰ø°ÊÅØ\r\n//         const location = mockLocations.find(loc => loc.id === locationId);\r\n//         if (!location) return;\r\n        \r\n//         // Êõ¥Êñ∞ÈÄâ‰∏≠ÁöÑ‰ΩçÁΩÆ\r\n//         setSelectedLocation(locationId);\r\n//         setLocationName(location.name);\r\n        \r\n//         // ‰ªéAPIÂä†ËΩΩËØÑËÆ∫\r\n//         const locationComments = await fetchComments(locationId);\r\n//         setComments(locationComments);\r\n        \r\n//         // ÊâìÂºÄËØÑËÆ∫ÂºπÁ™ó\r\n//         setIsCommentsPaneOpen(true);\r\n        \r\n//         // Êõ¥Êñ∞URLÂπ∂Êé®ÂÖ•ÂéÜÂè≤ËÆ∞ÂΩïÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ\r\n//         if (pushHistory) {\r\n//             const url = new URL(window.location.href);\r\n//             url.searchParams.set('location', locationId);\r\n//             window.history.pushState({ locationId }, '', url);\r\n//         }\r\n        \r\n//         // ÈáçÊñ∞Ê∏≤ÊüìÊ†áËÆ∞‰ª•Êõ¥Êñ∞ÈÄâ‰∏≠Áä∂ÊÄÅ\r\n//         addMarkersToMap(mockLocations);\r\n        \r\n//         // Â±Ö‰∏≠ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÊ†áËÆ∞\r\n//         if (mapInstanceRef.current) {\r\n//             mapInstanceRef.current.setView([location.latitude, location.longitude], 14);\r\n//         }\r\n//     };\r\n\r\n//     // ÂÖ≥Èó≠ËØÑËÆ∫ÂºπÁ™ó\r\n//     const closeCommentsPane = () => {\r\n//         setIsCommentsPaneOpen(false);\r\n//         setSelectedLocation(null);\r\n//         setLocationName('');\r\n//         setComments([]);\r\n//         setNewComment('');\r\n//         setError('');\r\n        \r\n//         // Êõ¥Êñ∞URL\r\n//         const url = new URL(window.location.href);\r\n//         url.searchParams.delete('location');\r\n//         window.history.pushState({}, '', url);\r\n        \r\n//         // ÈáçÊñ∞Ê∏≤ÊüìÊ†áËÆ∞‰ª•Ê∏ÖÈô§ÈÄâ‰∏≠Áä∂ÊÄÅ\r\n//         addMarkersToMap(mockLocations);\r\n        \r\n//         // ÈáçÁΩÆÂú∞ÂõæËßÜÂõæ\r\n//         if (mapInstanceRef.current) {\r\n//             mapInstanceRef.current.setView([22.3193, 114.1694], 12);\r\n//         }\r\n//     };\r\n\r\n//     // Ê∑ªÂä†ËØÑËÆ∫\r\n//     const handleAddComment = async () => {\r\n//         if (newComment.trim() === '' || !selectedLocation) return;\r\n        \r\n//         try {\r\n//             // Ê®°ÊãüÂΩìÂâçÁî®Êà∑ÔºàÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•‰ªéÁôªÂΩïÁä∂ÊÄÅËé∑ÂèñÔºâ\r\n//             const currentUser = localStorage.getItem('currentUser') || 'Current User';\r\n            \r\n//             const commentData = {\r\n//                 locationId: selectedLocation,\r\n//                 username: currentUser,\r\n//                 text: newComment.trim()\r\n//             };\r\n            \r\n//             // Êèê‰∫§ËØÑËÆ∫Âà∞ÂêéÁ´ØAPI\r\n//             const newCommentObj = await submitComment(commentData);\r\n            \r\n//             // Êõ¥Êñ∞ËØÑËÆ∫ÂàóË°®\r\n//             setComments(prevComments => [...prevComments, newCommentObj]);\r\n//             setNewComment('');\r\n            \r\n//         } catch (error) {\r\n//             console.error('Failed to add comment:', error);\r\n//             // ÈîôËØØ‰ø°ÊÅØÂ∑≤ÁªèÂú®submitCommentÂáΩÊï∞‰∏≠ËÆæÁΩÆ‰∫Ü\r\n//         }\r\n//     };\r\n\r\n//     // Â§ÑÁêÜÈîÆÁõò‰∫ã‰ª∂\r\n//     useEffect(() => {\r\n//         const handleKeyDown = (e) => {\r\n//             if (e.key === 'Escape' && isCommentsPaneOpen) {\r\n//                 closeCommentsPane();\r\n//             }\r\n//         };\r\n\r\n//         window.addEventListener('keydown', handleKeyDown);\r\n//         return () => window.removeEventListener('keydown', handleKeyDown);\r\n//     }, [isCommentsPaneOpen]);\r\n\r\n//     return (\r\n//         <div style={styles.app}>\r\n//             <header style={styles.header}>\r\n//                 <h1 style={styles.headerTitle}>Cultural Events Hong Kong</h1>\r\n//             </header>\r\n            \r\n//             <main style={styles.main}>\r\n//                 {/* Âú∞ÂõæÂÆπÂô® */}\r\n//                 <div style={styles.mapContainer}>\r\n//                     <div ref={mapRef} style={styles.mainMap} />\r\n//                 </div>\r\n                \r\n//                 {/* ËØÑËÆ∫ÂºπÁ™ó */}\r\n//                 <div \r\n//                     ref={paneRef}\r\n//                     style={styles.commentsPane}\r\n//                 >\r\n//                     <div style={styles.paneHeader}>\r\n//                         <div>\r\n//                             <h2 style={styles.paneTitle}>{locationName}</h2>\r\n//                             {locationName && (\r\n//                                 <div style={styles.locationName}>\r\n//                                     Comments\r\n//                                 </div>\r\n//                             )}\r\n//                         </div>\r\n//                         <button \r\n//                             onClick={closeCommentsPane}\r\n//                             style={styles.closeButton}\r\n//                             aria-label=\"Close comments pane\"\r\n//                         >\r\n//                             √ó\r\n//                         </button>\r\n//                     </div>\r\n                    \r\n//                     <div style={styles.paneContent}>\r\n//                         <div style={styles.commentsSection}>\r\n//                             <div style={styles.commentsCount}>\r\n//                                 {comments.length} {comments.length === 1 ? 'Comment' : 'Comments'}\r\n//                             </div>\r\n                            \r\n//                             {error && (\r\n//                                 <div style={styles.errorMessage}>\r\n//                                     {error}\r\n//                                 </div>\r\n//                             )}\r\n                            \r\n//                             <div style={styles.commentsList}>\r\n//                                 {isLoading ? (\r\n//                                     <div style={styles.loadingIndicator}>\r\n//                                         Loading comments...\r\n//                                     </div>\r\n//                                 ) : comments.length > 0 ? (\r\n//                                     comments.map((comment) => (\r\n//                                         <div key={comment.id} style={styles.commentItem}>\r\n//                                             <div style={styles.commentHeader}>\r\n//                                                 <span style={styles.commentAuthor}>\r\n//                                                     {comment.username}\r\n//                                                 </span>\r\n//                                                 <span style={styles.commentDate}>\r\n//                                                     {comment.date}\r\n//                                                 </span>\r\n//                                             </div>\r\n//                                             <div style={styles.commentText}>\r\n//                                                 {comment.text}\r\n//                                             </div>\r\n//                                         </div>\r\n//                                     ))\r\n//                                 ) : (\r\n//                                     <div style={styles.noComments}>\r\n//                                         No comments yet for this location.\r\n//                                         <div style={{ marginTop: '0.5rem', fontSize: '0.8rem' }}>\r\n//                                             Be the first to share your experience!\r\n//                                         </div>\r\n//                                     </div>\r\n//                                 )}\r\n//                             </div>\r\n                            \r\n//                             <div style={styles.addCommentSection}>\r\n//                                 <div style={styles.commentFormTitle}>\r\n//                                     Add a Comment\r\n//                                 </div>\r\n//                                 <textarea\r\n//                                     value={newComment}\r\n//                                     onChange={(e) => setNewComment(e.target.value)}\r\n//                                     placeholder=\"Share your thoughts about this venue...\"\r\n//                                     style={styles.commentTextarea}\r\n//                                     rows=\"3\"\r\n//                                     disabled={isLoading}\r\n//                                 />\r\n//                                 <button\r\n//                                     onClick={handleAddComment}\r\n//                                     style={{\r\n//                                         ...styles.submitButton,\r\n//                                         ...(newComment.trim() === '' || isLoading ? styles.submitButtonDisabled : {})\r\n//                                     }}\r\n//                                     disabled={newComment.trim() === '' || isLoading}\r\n//                                 >\r\n//                                     {isLoading ? 'Posting...' : 'Post Comment'}\r\n//                                 </button>\r\n//                             </div>\r\n//                         </div>\r\n//                     </div>\r\n//                 </div>\r\n                \r\n//                 {/* Âè†Âä†Â±ÇÔºàÁÇπÂáªÂÖ≥Èó≠ÂºπÁ™óÔºâ */}\r\n//                 {isCommentsPaneOpen && (\r\n//                     <div \r\n//                         style={styles.overlay}\r\n//                         onClick={closeCommentsPane}\r\n//                     />\r\n//                 )}\r\n//             </main>\r\n            \r\n//             <footer style={{\r\n//                 background: '#2c3e50',\r\n//                 color: 'white',\r\n//                 textAlign: 'center',\r\n//                 padding: '1rem',\r\n//                 fontSize: '0.9rem'\r\n//             }}>\r\n//                 <p>¬© 2024 Cultural Events Web Application | Click on any marker to view and post comments</p>\r\n//             </footer>\r\n//         </div>\r\n//     );\r\n// };\r\n\r\n// export default MapPage;"],"mappings":"AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}